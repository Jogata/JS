<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  </head>
  <body>
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->
    <script>
      function search() {
   const searchText = document.getElementById("searchText").value;
   const lis = document.getElementsByTagName("li");
   let matches = 0;

   for (const li of lis) {
      // console.log(li.textContent);
      if (li.textContent.includes(searchText)) {
         li.style.textDecoration = "underline";
         li.style.fontWeight = "bold";
         matches++;
         // console.log("ok");
      } else {
         li.style.textDecoration = "none";
         li.style.fontWeight = "initial";
         // console.log("not ok");
      }
   }

   const result = document.getElementById("result");
   result.textContent = `${matches} matches found`;
   document.getElementById("searchText").value = "";
}
    </script>

    <script>
      const weddingDay = {
  pickVenue(capacity, pricePerGuest, location) {
      if (typeof capacity !== 'number' || 
      typeof pricePerGuest !== 'number' || 
      typeof location !== 'string' || 
      location === '') {
          throw new Error("Invalid Information!");
        };
          if (location == "Varna") {

              if (capacity >= 150 && pricePerGuest <= 120) {
                  return `This venue meets the requirements, with capacity of ${capacity} guests and ${pricePerGuest}$ cover.`;
              } else {
                  return `This venue does not meet your requirements!`;
              }
          } else {
                throw new Error(`The location of this venue is not in the correct area!`);
          };
  },
  otherSpendings(weddingDecoration, photography, discount) {
      if (!Array.isArray(weddingDecoration) || 
      !Array.isArray(photography) || 
      typeof discount !== "boolean") {
        throw new Error("Invalid Information!");
      }
      let totalPrice = 0;
  
      weddingDecoration.forEach((decoration) => {
        if (decoration === "flowers") {
          totalPrice += 500;
        } else if (decoration === "Fabric drapes and curtains") {
          totalPrice += 400;
        }
      });
  
      photography.forEach((service) => {
        if (service === "pictures") {
          totalPrice += 700;
        } else if (service === "video") {
          totalPrice += 1300;
        }
      });

      if (discount) {
        totalPrice = totalPrice * 0.85;
        return `You spend ${totalPrice}$ for wedding decoration and photography with 15% discount!`;
      } else {
        return `You spend ${totalPrice}$ for wedding decoration and photography!`;
      }
  
    }
  ,
  tableDistribution(guests, tables) {
      if (typeof guests !== "number" || guests <= 0 ||
          typeof tables !== "number" || tables <= 0) {
          throw new Error("Invalid Information!");
      }

      let peopleOnTable = Math.round(guests / tables);

      if (peopleOnTable < 6) {
          return `There is only ${peopleOnTable} people on every table, you can join some tables.`;
      } else {
          return `You have ${tables} tables with ${peopleOnTable} guests on table.`;
      }
  }
}

describe('test weddingDay', function () {
    it('pickVenue functionality', function () {
        // capacity, pricePerGuest, location
        expect(weddingDay.pickVenue(150, 120, "Varna")).to.equal("This venue meets the requirements, with capacity of 150 guests and 120$ cover.");
        expect(weddingDay.pickVenue(180, 120, "Varna")).to.equal("This venue meets the requirements, with capacity of 180 guests and 120$ cover.");
        expect(weddingDay.pickVenue(150, 100, "Varna")).to.equal("This venue meets the requirements, with capacity of 150 guests and 100$ cover.");
        expect(weddingDay.pickVenue(100, 120, "Varna")).to.equal("This venue does not meet your requirements!");
        expect(weddingDay.pickVenue(150, 200, "Varna")).to.equal("This venue does not meet your requirements!");
        expect(weddingDay.pickVenue(100, 200, "Varna")).to.equal("This venue does not meet your requirements!");
        expect(() => weddingDay.pickVenue(6, 6, "")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, 6, 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, 6, [])).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, 6, {})).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue("6", 6, "Varna")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue([], 6, "Varna")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue({}, 6, "Varna")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, "6", "Varna")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, [], "Varna")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, {}, "Varna")).to.throw("Invalid Information!");
        expect(() => weddingDay.pickVenue(6, 6, "Sofia")).to.throw("The location of this venue is not in the correct area!");
    })
    it('otherSpendings functionality', function () {
        // weddingDecoration, photography, discount
        expect(() => weddingDay.otherSpendings([], {}, true)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings([], "6", true)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings([], 6, true)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings({}, [], true)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings(6, [], true)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings("6", [], true)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings("6", [], "true")).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings("6", [], 9)).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings("6", [], {})).to.throw("Invalid Information!");
        expect(() => weddingDay.otherSpendings("6", [], [])).to.throw("Invalid Information!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains"], ["pictures", "video"], false)).to.equal("You spend 2900$ for wedding decoration and photography!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains", "unknown"], ["pictures", "video"], false)).to.equal("You spend 2900$ for wedding decoration and photography!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains"], ["pictures", "video", "unknown"], false)).to.equal("You spend 2900$ for wedding decoration and photography!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains", "unknown", "flowers"], ["pictures", "video"], false)).to.equal("You spend 3400$ for wedding decoration and photography!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains"], ["pictures", "video"], true)).to.equal("You spend 2465$ for wedding decoration and photography with 15% discount!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains", "unknown"], ["pictures", "video"], true)).to.equal("You spend 2465$ for wedding decoration and photography with 15% discount!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains"], ["pictures", "video", "unknown"], true)).to.equal("You spend 2465$ for wedding decoration and photography with 15% discount!");
        expect(weddingDay.otherSpendings(["flowers", "Fabric drapes and curtains", "unknown", "flowers"], ["pictures", "video"], true)).to.equal("You spend 2890$ for wedding decoration and photography with 15% discount!");
    })
    it('tableDistribution  functionality', function () {
        // guests, tables
        expect(() => weddingDay.tableDistribution("6", 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution({}, 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution([], 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(true, 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(-6, 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(0, 6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(6, 0)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(6, -6)).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(6, "6")).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(6, [])).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(6, {})).to.throw("Invalid Information!");
        expect(() => weddingDay.tableDistribution(6, false)).to.throw("Invalid Information!");
        expect(weddingDay.tableDistribution(100, 10)).to.equal("You have 10 tables with 10 guests on table.");
        expect(weddingDay.tableDistribution(1000, 10)).to.equal("You have 10 tables with 100 guests on table.");
        expect(weddingDay.tableDistribution(342, 12)).to.equal("You have 12 tables with 29 guests on table.");
        expect(weddingDay.tableDistribution(341, 12)).to.equal("You have 12 tables with 28 guests on table.");
        expect(weddingDay.tableDistribution(12, 2)).to.equal("You have 2 tables with 6 guests on table.");
        expect(weddingDay.tableDistribution(11, 2)).to.equal("You have 2 tables with 6 guests on table.");
        expect(weddingDay.tableDistribution(10, 2)).to.equal("There is only 5 people on every table, you can join some tables.");
        expect(weddingDay.tableDistribution(9, 2)).to.equal("There is only 5 people on every table, you can join some tables.");
        expect(weddingDay.tableDistribution(8, 3)).to.equal("There is only 3 people on every table, you can join some tables.");
        expect(weddingDay.tableDistribution(7, 3)).to.equal("There is only 2 people on every table, you can join some tables.");
    })
})
    </script>

<script>
  // 10. Contacts Builder✶
  // 11. View Model✶
  // 12. Payment Package
  // 13. String Builder *✶
</script>

    <!-- ================= Get data from local JSON file ================= -->

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>