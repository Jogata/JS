<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <style>
      @import url('https://fonts.googleapis.com/css?family=Raleway');

body {
    width: 20%;
    margin: 0 auto;
    padding-top: 20px;
    font-family: 'Raleway',sans-serif;
}

#wrapper{
    background: #DDDDDD;
    text-align: center;
    padding: 40px 20px;
    border-radius: 10px;
}

input[type="text"] {
    margin-bottom: 10px;
    padding: 5px 0;
    border-radius: 5px;
    font-weight: 700;
}
 #result{
     font-weight: 700;
     color: cadetblue;
 }

 #wrapper input {
     padding: 4px;
     border: 2px solid cadetblue;
 }
    </style>
  </head>
  <body>
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <div id="wrapper">
      <input type="text" id="firstNumber" value="13.33" disabled>
      <input type="text" id="secondNumber" value="22.18" disabled>

      <div id="result"></div>
  </div>
  <script src="subtract.js"></script>
  <script>
      window.onload = function() {
          subtract();
          solve();
      }

      function subtract() {
        const firstNumber = document.getElementById("firstNumber");
        const secondNumber = document.getElementById("secondNumber");
        // console.log(firstNumber.value);
        const n1 = Number(firstNumber.value);
        const n2 = Number(secondNumber.value);
        const resultPanel = document.getElementById("result");
        const result = n1 - n2;
        // console.log(result);
        resultPanel.textContent = result;
    }
  </script>

<form>
  <div>
      <label for="text">Text: </label>
      <input type="text" id="text">
  </div>
  <div>
      <label for="naming-convention">Naming Convention: </label>
      <input type="text" id="naming-convention">
  </div>

  <input type="button" onclick="solve()" value="Transform">
</form>
<div class="result-container">Result: <span id="result"></span></div>
<script>
  function solve() {
  const resultField = document.getElementById("result");
  const textField = document.getElementById("text");
  const conventionField = document.getElementById("naming-convention");
  const text = textField.value.toLowerCase();
  // console.log(text);
  const words = text.split(" ");
  // console.log(words);
  const convention = conventionField.value.split(" ")[0];
  // console.log(convention);

  const callbacks = {
    Camel: "camel",
    Pascal: "pascal"
  }

  const callbacks2 = {
    camel: convertToCamel,
    pascal: convertToPascal, 
    undefined: () => {resultField.textContent = "Error!"}
  }

  let callback = callbacks[convention];
  // console.log(callback);
  callback = callbacks2[callback];
  // console.log(callback);
  callback();

  function convertToCamel() {
    const result = [];
    result.push(words[0]);
    
    for (let index = 1; index < words.length; index++) {
      let word = words[index];
      word = word.replace(word[0], word[0].toUpperCase());
      result.push(word);
    }

    resultField.textContent = result.join("");

  }

  function convertToPascal() {
    // console.log("pascal");
    const result = [];
    
    for (let index = 0; index < words.length; index++) {
      let word = words[index];
      word = word.replace(word[0], word[0].toUpperCase());
      result.push(word);
    }

    resultField.textContent = result.join("");
  }
}
</script>

    <script>
      class JobOffers {
          constructor(employer, position) {
              this.employer = employer;
              this.position  = position;
              this.jobCandidates = [];
          }

          jobApplication(candidates) {

              const added = [];

              for (const candidate of candidates) {
                  const data = candidate.split("-");
                  const name = data[0];
                  const education = data[1];
                  const yearsExperience = Number(data[2]);
                  // console.log(this.jobCandidates);

                  const index = this.jobCandidates.findIndex(candidate => candidate.name == name);
                  // console.log(index);

                  if (index >= 0) {
                      
                      const candidate = this.jobCandidates[index];
                      
                      if (candidate.yearsExperience < yearsExperience) {
                          candidate.yearsExperience = yearsExperience;
                      }

                  } else {
                      
                      const candidate = {
                          name, 
                          education, 
                          yearsExperience
                      }

                      this.jobCandidates.push(candidate);
                      added.push(name);
                      
                  }

              }

              return `You successfully added candidates: ${added.join(", ")}.`;
              
          }

          jobOffer(chosenPerson) {

              const data = chosenPerson.split("-");
              const name = data[0];
              const minimalExperience = Number(data[1]);

              const index = this.jobCandidates.findIndex(candidate => candidate.name == name);
              
              if (index < 0) {
                  throw new Error(`${name} is not in the candidates list!`);
              }

              const candidate = this.jobCandidates[index];

              if (candidate.yearsExperience < minimalExperience) {
                  throw new Error(`${name} does not have enough experience as ${this.position}, minimum requirement is ${minimalExperience} years.`);
              }

              candidate.yearsExperience = "hired";

              return `Welcome aboard, our newest employee is ${name}.`;

          }

          salaryBonus(name) {

              const index = this.jobCandidates.findIndex(candidate => candidate.name == name);
              
              if (index < 0) {
                  throw new Error(`${name} is not in the candidates list!`);
              }

              const candidate = this.jobCandidates[index];
              // console.log(candidate);

              const validEducations = {
                  "Bachelor": "Bachelor", 
                  "Master": "Master"
              }

              const messages = {
                  "Bachelor": `${name} will sign a contract for ${this.employer}, as ${this.position} with a salary of $50,000 per year!`, 
                  "Master": `${name} will sign a contract for ${this.employer}, as ${this.position} with a salary of $60,000 per year!`, 
                  "undefined": `${name} will sign a contract for ${this.employer}, as ${this.position} with a salary of $40,000 per year!`
              }

              const desiredDegree = validEducations[candidate.education];
              const message = messages[desiredDegree];

              return message;

          }

          candidatesDatabase() {

              if (this.jobCandidates.length == 0) {
                  throw new Error("Candidate Database is empty!");
              }

              const result = ["Candidates list:"];

              const sorted = this.jobCandidates.sort((c1, c2) => c1.name.localeCompare(c2.name));

              for (const candidate of sorted) {
                  // console.log(candidate);
                  const info = `${candidate.name}-${candidate.yearsExperience}`;
                  result.push(info);
              }

              return result.join("\n");

          }

      }

      // let Jobs = new JobOffers ("Google", "Strategy Analyst");
      // console.log(Jobs.jobApplication(["John Doe-Bachelor-10", "Peter Parker-Master-5", "Daniel Jones- Bachelor-18"]));

      // let Jobs = new JobOffers ("Google", "Strategy Analyst");
      // console.log(Jobs.jobApplication(["John Doe-Bachelor-10", "Peter Parker-Master-5", "Daniel Jones- Bachelor-18"]));
      // console.log(Jobs.jobOffer("John Doe-8"));
      // console.log(Jobs.jobOffer("Peter Parker-4"));
      // console.log(Jobs.jobOffer("John Jones-8"));

      // let Jobs = new JobOffers ("Google", "Strategy Analyst");
      // console.log(Jobs.jobApplication(["John Doe-Bachelor-10", "Peter Parker-Master-5", "Daniel Jones- Bachelor-18"]));
      // console.log(Jobs.jobOffer("John Doe-8"));
      // console.log(Jobs.jobOffer("Peter Parker-4"));
      // console.log(Jobs.salaryBonus("John Doe"));
      // console.log(Jobs.salaryBonus("Peter Parker"));

      let Jobs = new JobOffers ("Google", "Strategy Analyst");
      console.log(Jobs.jobApplication(["John Doe-Bachelor-10", "Peter Parker-Master-5","Jordan Cole-High School-5", "Daniel Jones- Bachelor-18"]));
      console.log(Jobs.jobOffer("John Doe-8"));
      console.log(Jobs.jobOffer("Peter Parker-4"));
      console.log(Jobs.jobOffer("Jordan Cole-4"));
      console.log(Jobs.salaryBonus("Jordan Cole"));
      console.log(Jobs.salaryBonus("John Doe"));
      console.log(Jobs.candidatesDatabase());

  </script>

<script>
  window.addEventListener('load', solve);
  
  function solve() {
      const form = document.querySelector("form");
      const partInfoList = document.querySelector(".info-list");
      const confirmList = document.querySelector(".confirm-list");
      // console.log(partInfoList, confirmList);
      
      const modelField = document.getElementById("car-model");
      const yearField = document.getElementById("car-year");
      const nameField = document.getElementById("part-name");
      const partNumberField = document.getElementById("part-number");
      const conditionField = document.getElementById("condition");
      // console.log(modelField, yearField, nameField, partNumberField, conditionField);
      
      modelField.value = "testmodel";
      yearField.value = 1980;
      nameField.value = "partNameTest";
      partNumberField.value = 7;
      conditionField.value = "New";
      
      const nextBtn = document.getElementById("next-btn");
      // console.log(nextBtn);
      
      nextBtn.addEventListener("click", (e) => {
          e.preventDefault();
          
          const modelFieldValue = modelField.value;
          const yearFieldValue = yearField.value;
          const nameFieldValue = nameField.value;
          const partNumberFieldValue = partNumberField.value;
          const conditionFieldValue = conditionField.value;
          // console.log(modelFieldValue, yearFieldValue, nameFieldValue, partNumberFieldValue, conditionFieldValue);
          
          if (modelFieldValue.length == 0) {
              console.log("model is empty");
              return;
          }
          
          if (yearFieldValue.toString().length == 0) {
              console.log("email is empty");
              return;
          } else if (yearFieldValue < 1980 || yearFieldValue > 2023) {
              console.log("wrong year");
              return;
          }
          
          if (nameFieldValue.length == 0) {
              console.log("number is empty");
              return;
          }
          
          if (partNumberFieldValue.toString().length == 0) {
              console.log("partNumber is empty");
              return;
          }
          
          if (conditionFieldValue.length == 0) {
              console.log("condition is empty");
              return;
          }
          
          form.reset();
          nextBtn.disabled = true;
          
          const selected = document.querySelectorAll("option[selected]");
          Array.from(selected).forEach(option => option.selected = false);

          const img = document.getElementById("complete-img");
          img.style.visibility = "hidden";

          const text = document.getElementById("complete-text");
          text.textContent = "";
          
          const li = document.createElement("li");
          li.classList.add("part-content");
          const html = `<article>
              <p>Car Model: ${modelFieldValue}</p>
              <p>Car Year: ${yearFieldValue}</p>
              <p>Part Name: ${nameFieldValue}</p>
              <p>Part Number: ${partNumberFieldValue}</p>
              <p>Condition: ${conditionFieldValue}</p>
            </article>`;
          li.innerHTML = html;
          
          const editBtn = document.createElement("button");
          editBtn.classList.add("edit-btn");
          editBtn.textContent = "Edit";
          editBtn.addEventListener("click", () => {
              // console.log("edit");
              nextBtn.disabled = false;
              li.remove();
          })
          
          const contBtn = document.createElement("button");
          contBtn.classList.add("continue-btn");
          contBtn.textContent = "Continue";
          contBtn.addEventListener("click", () => {
              // console.log("continue");
              editBtn.remove();
              contBtn.remove();
              
              li.className = "continue-info";
              
              const cancelBtn = document.createElement("button");
              cancelBtn.classList.add("cancel-btn");
              cancelBtn.textContent = "Cancel";
              cancelBtn.addEventListener("click", () => {
                      li.remove();
                      nextBtn.disabled = false;
              })
              li.appendChild(cancelBtn);
              
              const confirmBtn = document.createElement("button");
              confirmBtn.classList.add("confirm-btn");
              confirmBtn.textContent = "Confirm";
              confirmBtn.addEventListener("click", () => {
                      // console.log("confirm");
                      li.remove();
                      nextBtn.disabled = false;
                      img.style.visibility = "visible";
                      text.textContent = "Part is Ordered!";
              })
              li.appendChild(confirmBtn);
              confirmList.appendChild(li);
          })
          li.appendChild(editBtn);
          li.appendChild(contBtn);
          partInfoList.appendChild(li);
      });
  }
</script>

<script>
  // 10. Contacts Builder✶
  // 11. View Model✶
  // 12. Payment Package
  // 13. String Builder *✶
</script>

    <!-- ================= Get data from local JSON file ================= -->

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>