<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <style>
      h1 {
        text-align: center;
      }
      h1 span {
        display: inline-block;
        margin-right: 10px;
        padding-right: 20px;
        border-right: 2px solid;
      }
      button {
        padding: 5px 10px;
        border-radius: 5px;
      }
      fieldset {
        margin: 2rem auto;
      }
    </style>
  </head>
  <body>
    <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1>
    <!-- ================= Get data from local JSON file ================= -->
    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      function barcodeGenerator(input) {
    let firstNum = input[0];
    let secondNum = input[1];
    let barcodes = '';
 
    for (let a = firstNum.charAt(0); a <= secondNum.charAt(0); a++) {
        for (let b = firstNum.charAt(1); b <= secondNum.charAt(1); b++) {
            for (let c = firstNum.charAt(2); c <= secondNum.charAt(2); c++) {
                for (let d = firstNum.charAt(3); d <= secondNum.charAt(3); d++) {
                    if (a % 2 !== 0 && b % 2 !== 0 && c % 2 !== 0 && d % 2 !== 0) {
                        if (barcodes !== '') {
                            barcodes += ' ';
                        }
                        barcodes += a.toString() + b + c + d;
                    }
                }
            }
        }
    }
    console.log(barcodes);
}

function demo(input) {
    let start = Number(input[0]);
    let end = Number(input[1]);
    let sum = 0;
    let output = '';
 
    for (let a = start; a <= end; a++) {
        if (a <= 0) {
            continue;
        } else if (a % 9 === 0) {
            sum = sum + a;
            output = output + `${a}\n`;
        }
    }
    console.log(`The sum: ${sum}`);
    console.log(output);
}

function numberPyramid(input) {
 
 let num = Number(input[0]);
 let currNum = 1;
 let output = '';

 for (let row = 1; row <= num; row++) {
     for (let column = 1; column <= row; column++) {
         if (currNum > num) {
             console.log(output);
             return;
         }
         output += currNum + ' ';
         currNum++;
     }
     console.log(output);
     output = '';
 }
}

function boatTrip(input){
    let buget = Number(input[0]);
    let season = input[1];
    let fishermanCount = Number(input[2]);
    
    let discountPerPerson = 0;
    let additionalDiscount = 0;
    let boatPrice = 0 ;
 
    if (fishermanCount % 2 ===0 && season !== "Autumn") {
         additionalDiscount = 0.05
    }

    if (fishermanCount <=6){
         discountPerPerson = 0.1
    }else if(fishermanCount <=11){ 
         discountPerPerson = 0.15
    }else if(fishermanCount>=12){
         discountPerPerson = 0.25
    }

if(season === "Spring") {
   boatPrice = 3000;
  } else if(season === "Winter") { 
    boatPrice = 2600
  } else if (season ==="Autumn") {
      boatPrice = 4200
    }else if(season ==="Summer"){
       boatPrice = 4200
      }
    
 
    let totalPrice=(boatPrice -(boatPrice * discountPerPerson) )   ;
    let finalsum = totalPrice -(totalPrice *additionalDiscount);
 
if(finalsum<buget){ 
    console.log(`Yes! You have ${(buget - finalsum).toFixed(2)} leva left.`);
}else{
  console.log(`Not enough money! You need ${(finalsum -buget).toFixed(2)} leva.`)
 }
 
}
 
// boatTrip(["2000", "Winter", "12"]);

function vacation(input) {
    let index = 0;
 
    let moneyNeeded = Number(input[index]);
    index++;
 
    let budget = Number(input[index]);
    index++
 
    let daysCount = 0;
    let daysSpendCount = 0
 
    while (budget < moneyNeeded) {
 
        let action = input[index];
        index++;
        let sum = Number(input[index]);
        index++;
 
        if (action === "save") {
            budget += sum;
            daysSpendCount = 0;
        } else if (action === "spend") {
            if (sum > budget) {
                budget = 0;
            } else {
                budget -= sum;
            }
            
            daysSpendCount++
        }

        daysCount++
 
        if (daysSpendCount === 5) {
            console.log("You can't save the money.");
            console.log(`${daysSpendCount}`);
            break;
        }
    }

    if (budget >= moneyNeeded) {
        console.log(`You saved the money for ${daysCount} days.`);
    }
}
    </script>
  </body>
</html>