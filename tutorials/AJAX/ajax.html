<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Mountains+of+Christmas&display=swap');

      fieldset {
        display: none;
      }
      
      body {
        margin: 0;
        font-family:'Franklin Gothic Medium', sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        background-image: url("../images/bg.jpg");
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-size: cover;
      }
      
      body > h1 {
        margin-top: -7px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: rgb(79, 131, 241);
        font-size: 10vh;
        font-family: 'Mountains of Christmas', serif;
        text-shadow: 3px 3px black;
      }
      
      .snowman-container {
        height: 93vh;
        margin-top: -90px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-image: url(../images/snowman.png);
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
      }
      
      .snowman {
        width: 45vw;
        display: flex;
        align-items: center;
        flex-direction: column;
        gap: 10px;
        margin-top: 9.5rem;
      }
      
      .snowman input, 
      .snowman button, 
      .snowman select {
        margin-right: 2rem;
        width: 10rem;
        height: 1.6rem;
      }
      
      .snowballs-container {
        align-items: center;
        gap: 10vh;
        display: flex;
        flex-direction: column;
        margin-right: 50px;
        margin-top: -20px;
      }
      
      .snowball {
        width: 45vw;
        height: 50vh;
        background-image: url(../images/snowball.png);
        background-repeat: no-repeat;
        background-position: center;
        background-size:contain;
        display: flex;
        align-items: center;
        flex-direction: column;
      }
      
      .snowball h2 {
        margin-top: 50px;
      }
      
      ul {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }
      
      .snow {
        width: 49vw;
        height: 22vh;
        background-image: url(../images/snow.png);
        background-repeat: no-repeat;
        background-position: center;
        background-size:contain;
        display: flex;
        justify-content: start;
        align-items: center;
        flex-direction: column;
      }
      
      main {
        display: flex;
        justify-content:space-between;
        
      }
      
      .snowman-preview li {
        display: flex;
        flex-direction: column;
        line-height: 9px;
        justify-content: center;
        align-items: center;
        font-weight: 600;
      }
      
      .btn-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }
      
      h2 {
        border-bottom: 2px dashed black;
        text-shadow: 1px 1px black;
        color: rgb(79, 131, 241);
      }
    </style>
  </head>
  <body>
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->
    <h1>Snow Showdown</h1>
    <main id="hero">

      <div class="snowman-container">
        <form class="snowman">
          <input type="text" id="snowman-name" placeholder="Snowman Name" />
          <input type="number" id="snowman-height" placeholder="Height (in centimeters)" />
          <input type="text" id="location" placeholder="Location" />
          <input type="text" id="creator-name" placeholder="Creator" />
          <select id="special-attribute" placeholder="Special Attribute">
            <option value="" disabled selected>Special Attribute</option>
            <option value="Carrot Nose">Carrot Nose</option>
            <option value="Hat/Pot">Hat/Pot</option>
            <option value="Branches for Arms">Branches for Arms</option>
            <option value="Button Eyes">Button Eyes</option>
          </select>
          <button type="submit" class="add-btn">Add</button>
        </form>
      </div>

      <div class="snowballs-container">
        <div class="snowball">
          <h2>&#10053;Snowman Preview&#10053;</h2>
          <ul class="snowman-preview"></ul>
        </div>

        <div class="snow">
          <h2>&#10053;Your Snowman&#10053;</h2>
          <ul class="snow-list"></ul>
        </div>

      </div>
    </main>
    <img id="back-img" src="./style/images/back-Snowman.png" alt="" hidden>
    <script>
      window.addEventListener("load", solve);

function solve() {
  const form = document.querySelector("form");
  const previewList = document.querySelector(".snowman-preview");
  const snowList = document.querySelector(".snow-list");
  // console.log(form, previewList ,snowList);

  const nameInput = document.getElementById("snowman-name");
  const heightInput = document.getElementById("snowman-height");
  const locationInput = document.getElementById("location");
  const creatorInput = document.getElementById("creator-name");
  const attributeInput = document.getElementById("special-attribute");
  // console.log(nameInput, heightInput, locationInput, creatorInput, attributeInput);

  const addBtn = document.querySelector(".add-btn");

  // nameInput.value = "TestName";
  // heightInput.value = 8;
  // locationInput.value = "test place";
  // creatorInput.value = "test creator";
  // attributeInput.value = "Hat/Pot";

  addBtn.addEventListener("click", (e) => {
      // console.log("get info");
      e.preventDefault();

      if (nameInput.value.length == 0) {
        // console.log("name is empty");
        return;
      }
      if (heightInput.value.toString().length == 0) {
        // console.log("height is empty");
        return;
      }
      if (locationInput.value.length == 0) {
        // console.log("location is empty");
        return;
      }
      if (creatorInput.value.length == 0) {
        // console.log("creator is empty");
        return;
      }
      if (attributeInput.value.length == 0) {
        // console.log("attr is empty");
        return;
    }

    const nameInputValue = nameInput.value;
    const heightInputValue = heightInput.value;
    const locationInputValue = locationInput.value;
    const creatorInputValue = creatorInput.value;
    const attributeInputValue = attributeInput.value;
    // console.log(nameInputValue, heightInputValue, locationInputValue, creatorInputValue, attributeInputValue);

    form.reset();
    addBtn.disabled = true;

    const li = document.createElement("li");
    const html = `<article><p>Name: ${nameInputValue}</p><p>Height: ${heightInputValue}</p><p>Location: ${locationInputValue}</p><p>Creator: ${creatorInputValue}</p><p>Attribute: ${attributeInputValue}</p><div class="btn-container"></div></article>`;
    li.classList.add("snowman-info");
    li.innerHTML = html;

    const btnContainer = li.querySelector(".btn-container");

    const editBtn = document.createElement("button");
    editBtn.textContent = "Edit";
    editBtn.classList.add("edit-btn");
    editBtn.addEventListener("click", () => {
        li.remove();
        nameInput.value = nameInputValue;
        heightInput.value = heightInputValue;
        locationInput.value = locationInputValue;
        creatorInput.value = creatorInputValue;
        attributeInput.value = attributeInputValue;
        btnContainer.remove();
        addBtn.disabled = false;
    })

    const nextBtn = document.createElement("button");
    nextBtn.textContent = "Next";
    nextBtn.classList.add("next-btn");
    nextBtn.addEventListener("click", () => {
      snowList.appendChild(li);
      li.className = "snowman-content";
      btnContainer.remove();

      const sendBtn = document.createElement("button");
      sendBtn.textContent = "Send";
      sendBtn.classList.add("send-btn");
      sendBtn.addEventListener("click", () => {
        // addBtn.disabled = false;
        const main = document.getElementById("hero");
        main.remove();
        const img = document.getElementById("back-img");
        img.removeAttribute("hidden");
        const backBtn = document.createElement("button");
        backBtn.textContent = "Back";
        backBtn.classList.add("back-btn");
        backBtn.addEventListener("click", () => {
          location.reload();
        })
        document.body.appendChild(backBtn);
      })
      li.firstChild.appendChild(sendBtn);
  });

    btnContainer.appendChild(editBtn);
    btnContainer.appendChild(nextBtn);
    previewList.appendChild(li);
  })
}
    </script>

<script>
  // 10. Contacts Builder✶
  // 11. View Model✶
  // 12. Payment Package
  // 13. String Builder *✶
</script>

    <!-- ================= Get data from local JSON file ================= -->

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>