<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <style>
      fieldset {
        display: none;
      }

      [role="tablist"] {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        gap: 1rem;
      }
      
      [aria-selected="true"] {
        /* text-decoration-thickness: 0.25em; */
        /* text-underline-offset: 0.5em; */
        color: orangered;
      }
      
      .tabs-container {
        padding: 2.5rem;
        border-radius: 0.5rem;
        background: hsl(0 0% 50% / 0.1);
      }
      
      :root {
        /* either --dark-mode or --no-dark-mode */
        --color-scheme: var(--dark-mode);
        
        --font-family: system-ui;
        
        --fs-300: clamp(0.94rem, calc(0.92rem + 0.08vw), 0.98rem);
        --fs-400: clamp(1.13rem, calc(1.06rem + 0.33vw), 1.31rem);
        --fs-500: clamp(1.35rem, calc(1.21rem + 0.69vw), 1.75rem);
        --fs-600: clamp(1.62rem, calc(1.37rem + 1.24vw), 2.33rem);
        --fs-700: clamp(1.94rem, calc(1.54rem + 2.03vw), 3.11rem);
        --fs-800: clamp(2.33rem, calc(1.7rem + 3.15vw), 4.14rem);
        --fs-900: clamp(2.8rem, calc(1.85rem + 4.74vw), 5.52rem);
        
        --clr-primary-300: hsl(219, 76%, 55%);
        --clr-primary-400: hsl(219, 76%, 40%);
        --clr-primary-500: hsl(219, 76%, 25%);
        --clr-secondary-300: hsl(269, 75%, 55%);
        --clr-secondary-400: hsl(269, 75%, 40%);
        --clr-secondary-500: hsl(269, 75%, 25%);
        --clr-accent-300: hsl(358, 72%, 65%);
        --clr-accent-400: hsl(358, 72%, 50%);
        --clr-accent-500: hsl(358, 72%, 35%);
        
        --no-dark-mode: light;
        --dark-mode: dark light;
      }
      
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      
      html {
        color-scheme: var(--color-scheme);
      }
      
      body {
        margin: 0;
        font-size: var(--fs-400);
        font-family: var(--font-family);
        line-height: 1.6;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">

      <h2 id="tabs-title">How our company can help you</h2>
    
      <div class="tabs-container">
        
        <ul aria-labelledby="tabs-title">
          <li><a id="tab-1" href="#advertising">Advertising</a></li>
          <li><a id="tab-2" href="#social-media">Socials</a></li>
          <li><a id="tab-3" href="#content-marketing">Marketing</a></li>
          <li><a id="tab-4" href="#email">Email</a></li>
        </ul>
    
        <div class="panels flow">

          <div id="advertising" aria-labelledby="tab-1">
            <p>
              A marketing company can use targeted advertising to reach specific
              audiences based on demographics, interests, and behaviors. This
              can increase the effectiveness of advertising campaigns and
              improve return on investment.
            </p>
          </div>

          <div id="social-media" aria-labelledby="tab-2">
            <p>
              A marketing company can leverage social media platforms to engage
              with customers and promote products or services. Social media can
              also be used to gather customer feedback and insights to inform
              future marketing strategies.
            </p>
          </div>

          <div id="content-marketing" aria-labelledby="tab-3">
            <p>
              A marketing company can use content marketing to attract and
              retain customers by creating and sharing valuable and relevant
              content. This can help to establish the company as a thought
              leader in its industry and build trust with customers.
            </p>
          </div>

          <div id="email" aria-labelledby="tab-4">
            <p>
              A marketing company can use email campaigns to communicate with
              customers and promote products or services. Email campaigns can be
              personalized and targeted to specific audiences to increase their
              effectiveness.
            </p>
          </div>

        </div>

      </div>
    
      <!-- filler content -->
    
      <section class="flow">
        <h2>More content here</h2>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Quod officia
          molestias alias optio aliquam totam est necessitatibus similique cum
          vero, iste dolorum debitis ex fuga minima? Delectus nostrum maxime
          soluta.
        </p>
        <p>
          Itaque tempore <a href="#">est rerum quidem</a> nostrum odio, saepe
          consequatur minus atque numquam voluptas quos veniam cumque, modi,
          nisi asperiores hic expedita fuga quod ratione veritatis tenetur?
          Velit, inventore? Possimus, cumque.
        </p>
        <p>
          Quia ullam repudiandae, commodi eius vitae adipisci laudantium numquam
          voluptas consectetur provident quo, cum vel nihil suscipit nam earum
          omnis. Aliquid reprehenderit voluptatem impedit nemo nulla quas
          ratione corporis ducimus!
        </p>
        <p>
          Itaque tempore <a href="#">est rerum quidem</a> nostrum odio, saepe
          consequatur minus atque numquam voluptas quos veniam cumque, modi,
          nisi asperiores hic expedita fuga quod ratione veritatis tenetur?
          Velit, inventore? Possimus, cumque.
        </p>
        <p>
          Quia ullam repudiandae, commodi eius vitae adipisci laudantium numquam
          voluptas consectetur provident quo, cum vel nihil suscipit nam earum
          omnis. Aliquid reprehenderit voluptatem impedit nemo nulla quas
          ratione corporis ducimus!
        </p>
        <p>
          Itaque tempore <a href="#">est rerum quidem</a> nostrum odio, saepe
          consequatur minus atque numquam voluptas quos veniam cumque, modi,
          nisi asperiores hic expedita fuga quod ratione veritatis tenetur?
          Velit, inventore? Possimus, cumque.
        </p>
        <p>
          Quia ullam repudiandae, commodi eius vitae adipisci laudantium numquam
          voluptas consectetur provident quo, cum vel nihil suscipit nam earum
          omnis. Aliquid reprehenderit voluptatem impedit nemo nulla quas
          ratione corporis ducimus!
        </p>
        <p>
          Itaque tempore <a href="#">est rerum quidem</a> nostrum odio, saepe
          consequatur minus atque numquam voluptas quos veniam cumque, modi,
          nisi asperiores hic expedita fuga quod ratione veritatis tenetur?
          Velit, inventore? Possimus, cumque.
        </p>
        <p>
          Quia ullam repudiandae, commodi eius vitae adipisci laudantium numquam
          voluptas consectetur provident quo, cum vel nihil suscipit nam earum
          omnis. Aliquid reprehenderit voluptatem impedit nemo nulla quas
          ratione corporis ducimus!
        </p>
      </section>

    </div>

    <script>
      const tabsContainer = document.querySelector(".tabs-container");
      const tabsList = tabsContainer.querySelector("ul");
      const tabButtons = tabsList.querySelectorAll("a");
      const tabPanels = tabsContainer.querySelectorAll(".panels > div");

      tabsList.setAttribute("role", "tablist");

      tabsList.querySelectorAll("li").forEach(li => {
        li.setAttribute("role", "presentation");
      })

      tabsContainer.addEventListener("click", (e) => {
        console.log(e.target);
        const tab = e.target.closest("a");
        if (!tab) {
          return;
        }
        console.log(tab);
        e.preventDefault();
        switchTab(tab);
      })

      function switchTab(tab) {
        const activePanelID = tab.getAttribute("href");
        const activePanel = tabsContainer.querySelector(activePanelID);

        tabPanels.forEach(panel => {
          panel.setAttribute("hidden", "true");
        })
        
        activePanel.removeAttribute("hidden");
        tab.setAttribute("aria-selected", "true");
      }

      tabButtons.forEach((tab, index) => {
        tab.setAttribute("role", "tab");
        if (index === 0) {
          tab.setAttribute("aria-selected", "true");
          // todo
        } else {
          console.log(index);
          tab.setAttribute("tabindex", "-1");
          tabPanels[index].setAttribute("hidden", "");
        }
      })

      tabPanels.forEach(panel => {
        panel.setAttribute("role", "tabpanel");
        panel.setAttribute("tabindex", "0");
      })
    </script>

    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <!-- ================= Get data from local JSON file ================= -->
    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>
  </body>
</html>