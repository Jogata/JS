<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  </head>
  <body>
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <!-- ================= Get data from local JSON file ================= -->

    <script>
      // 06. Word Occurrences
    
      function findWordOccurrences(params) {
        // console.log(params);
        const occurrences = {};
    
        for (const word of params) {
          // console.log(word);
          if (!occurrences[word]) {
            occurrences[word] = 0;
          }
    
          occurrences[word]++;
    
        }
    
        // console.log(occurrences);
        const entries = Object.entries(occurrences);
        // console.log(entries);
        const sorted = entries.sort((a, b) => b[1] - a[1]);
        // console.log(sorted);
    
        for (const item of sorted) {
          const word = item[0];
          const occurrences = item[1];
          console.log(`${word} -> ${occurrences} times`);
        }
    
      }
    
      // findWordOccurrences(["Here", "is", "the", "first", "sentence", "Here", "is", "another", "sentence", "And", "finally", "the", "third", "sentence"]);
      // findWordOccurrences(["dog", "bye", "city", "dog", "dad", "boys", "ginger"]);
    </script>
    <script>
        // 03. Add and Remove Elements

  function createArr(params) {
    const result = [];
    let num = 1;

    const commands = {
      add: (num) => {
        num++;
        result.push(num);
      }, 
      remove: (num) => {
        num++;
        result.pop();
      }
    }

    for (let index = 0; index < params.length; index++) {
      const command = commands[params[index]];
      command(index);
    }

    if (result.length == 0) {
      console.log("Empty");
    } else {
      for (const number of result) {
        console.log(number);
      }
    }
    // return result;

  }

  // createArr(['add', 'add', 'add', 'add']);
  // createArr(['add', 'add', 'remove', 'add', 'add']);
  // createArr(['remove', 'remove', 'remove']);
    </script>
    <script>
      // 01. Reveal Words

function revealWords(params, phrase) {
const words = params.split(", ");
// console.log(words);
// let result = "";

for (const word of words) {
  // console.log(word);
  const length = word.length;
  // console.log(length);
  const splited = phrase.split(" ");
  const searched = "*".repeat(length);
  // console.log(searched);
  const index = splited.indexOf(searched);
  // console.log(index);
  if (index) {
    splited[index] = word;
  }
  phrase = splited.join(" ");
}

console.log(phrase);

}

// revealWords('great', 'softuni is ***** place for learning new programming languages');
// revealWords('great, learning', 'softuni is ***** place for ******** new programming languages');

// 02. Modern Times of #(HashTag)

function findHashTags(phrase) {
// console.log(phrase);
const words = phrase.split(" ");
// console.log(words);
const filtered = words.filter(x => x.startsWith("#") && x.length > 1);
// console.log(filtered);

for (let word of filtered) {
  let isNumber = false;
  for (const letter of word) {
    // console.log(Number.parseInt(letter));
    // console.log(letter);
    if (Number.parseInt(letter)) {
      isNumber = true;
      // console.log(word);
      break;
    }
  }

  if (!isNumber) {
    word = word.replace("#", "");
    console.log(word);
  }
}

}

// findHashTags('Nowadays everyone uses # to tag a #spec1ial word in #socialMedia');
// findHashTags('The symbol # is known #variously in English-speaking #regions as the #number sign');
    </script>

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>
    <script>
      // 03. Extract File

function extractFile(path) {
// console.log(path);
const parts = path.split("\\");
// console.log(parts);
const file = parts[parts.length - 1];
// console.log(file);
const fileParts = file.split(".");
// console.log(fileParts);
let fileName = "";
const ext = fileParts[fileParts.length - 1];
// console.log(ext);

for (let index = 0; index < fileParts.length - 2; index++) {
  let part = fileParts[index] + ".";
  fileName += part;
}

fileName += fileParts[fileParts.length - 2];

console.log(`File name: ${fileName}`);
console.log(`File extension: ${ext}`);

}

// extractFile("C:\\Internal\\training-internal\\Template.bss.pptx");
// extractFile('C:\\Projects\\Data-Structures\\LinkedList.cs');

// 04. String Substring

function findString(searched, phrase) {
// console.log(phrase);
// console.log(searched);
const words = phrase.split(" ");
let isFound = false;

for (const word of words) {
  if (searched.toLowerCase() == word.toLowerCase()) {
    isFound = true;
    break;
  }
}

if (isFound) {
  console.log(searched);
} else {
  console.log(`${searched} not found!`);
}

}

// findString('javascript', 'JavaScript is the best programming language');
// findString('python', 'JavaScript is the best programming language');

// 05. Replace Repeating Chars

function replaceRepeatingChars(word) {
// console.log(word);
let current = word[0];
let newWord = current;

for (let index = 1; index < word.length; index++) {
  if (word[index] != current) {
    current = word[index];
    newWord += current;
  }
}

console.log(newWord);

}

function replaceRepeatingChars(word) {
// console.log(word);

for (let index = 0; index < word.length - 1; index++) {
  if (word[index] == word[index + 1]) {
    let current = word[index];
    const removed = current + current;
    word = word.replaceAll(removed, current);
    index = -1;
  }
  
}
// word = word.replaceAll("aa", "a");
console.log(word);

}

// replaceRepeatingChars('aaaaabbbbbcdddeeeedssaa');
// replaceRepeatingChars('qqqwerqwecccwd');

// 06. Pascal-Case Splitter

function splitPascal(phrase) {
// console.log(phrase.length);
const indexes = [];

for (let index = 0; index < phrase.length; index++) {
  const letter = phrase[index];
  const ascii = letter.charCodeAt(0);
  if (ascii > 64 && ascii < 91) {
    // console.log(letter, ascii);
    indexes.push(index);
  }
}
indexes.push(phrase.length);
// console.log(indexes);
const words = [];

for (let index = 0; index < indexes.length - 1; index++) {
  const start = indexes[index];
  const end = indexes[index + 1];
  const word = phrase.slice(start, end);
  // console.log(word);
  words.push(word);
}

console.log(words.join(', '));

}

// splitPascal('SplitMeIfYouCanHaHaYouCantOrYouCan');
// splitPascal('HoldTheDoor');
// splitPascal('ThisIsSoAnnoyingToDo');
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>