<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap");
      fieldset {
        display: none;
      }
      :root {
        --primary-color: #b1a88b;
        --primary-color-dark: #8f8871;
        --text-dark: #333333;
        --text-light: #767278;
        --extra-light: #ffffff;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        min-height: 100vh;
        display: flex;
        /* align-items: center; */
        /* justify-content: center; */
        font-family: "Roboto", sans-serif;
        background-image: linear-gradient(
          rgba(255, 255, 255, 0.5), 
          rgba(255, 255, 255, 0.5)
        ), url("./assets/pexels-nancy-bourque-1209978.jpg");
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
      }
      .profile-card {
        width: 700px;
        margin: auto;
        border-radius: 10px;
        box-shadow: 3px 3px 5px var(--text-light);
        overflow: hidden;
      }
      .header {
        position: relative;
        height: 10rem;
        background-image: url("./assets/pexels-nancy-bourque-1209978.jpg");
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
      }
      .header img {
        position: absolute;top: 2rem;
        left: 2rem;
        width: 10rem;
        height: 10rem;
        border-radius: 50%;
        border: 0.2rem solid var(--extra-light);
        box-shadow: 3px 3px 5px var(--text-light);
      }
      .follow {
        position: absolute;
        right: 2rem;
        bottom: 1rem;
        padding: 0.75em 2em;
        color: var(--extra-light);
        font-size: 0.8rem;
        font-weight: 600;
        font-family: inherit;
        text-transform: capitalize;
        outline: none;
        border: none;
        border-radius: 5px;
        background-color: var(--primary-color);
        transition: all 0.3s;
        cursor: pointer;
      }
      .follow:hover {
        background-color: var(--primary-color-dark);
      }
      .content {
        padding: 2rem;
        display: flex;
        gap: 2rem;
        background-color: var(--extra-light);
      }
      .left {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }
      .left h2 {
        color: var(--text-dark);
        font-size: 1.5rem;
        font-weight: 400;
        text-transform: capitalize;
      }
      .left p {
        color: var(--text-light);
        font-size: 0.8rem;
      }
      .left hr {
        width: 100%;
        margin: 1rem 0;
      }
      .media {
        display: flex;
        gap: 1rem;
        align-items: center;
      }
      .followers {
        display: flex;
        flex-direction: column;
        color: var(--text-light);
      }
      .count {
        font-size: 1.5rem;
      }
      .text {
        font-size: 0.8rem;
      }
      .avatars img {
        width: 30px;
        height: 30px;
        margin-right: -15px;
        border-radius: 50%;
      }
      .avatars .more {
        display: inline-block;
        width: 30px;
        height: 30px;
        vertical-align: top;
        /* margin-right: -15px; */
        color: var(--extra-light);
        font-size: 12px;
        font-weight: bold;
        text-align: center;
        line-height: 30px;
        background-color: var(--text-dark);
        border-radius: 50%;
      }
      .right {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        flex-direction: column;
      }
      .feed-card {
        width: 100%;
        padding: 1rem;
        border: 1px solid var(--text-light);
        border-radius: 5px;
        box-shadow: 3px 3px 5px var(--text-light);
      }
      .feed {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }
      .feed img {
        width: 30px;
      }
      .feed h5 {
        margin-bottom: 5px;
        color: var(--text-dark);
        font-size: 0.9rem;
        font-weight: 500;
      }
      .social-icons {
        display: flex;
        gap: 1rem;
        align-items: center;
      }
      .icon {
        color: var(--text-light);
        font-size: 0.8rem;
        transition: all 0.3s;
        cursor: pointer;
      }
      .icon:hover {
        color: var(--text-dark);
      }
      .feed:nth-child(1) {
        padding-bottom: 1rem;
      }
      .feed:nth-child(3) {
        padding-top: 1rem;
      }
    </style>
  </head> 
  <body>
    <div class="profile-card">
      <div class="header">
        <img src="./assets/433719638_968658111290327_8362694328875161291_n.jpg" alt="">
        <button class="follow">follow</button>
      </div>
      <div class="content">
        <div class="left">
          <h2>john doe</h2>
          <p>@DrWatson</p>
          <hr>
          <div class="media">
            <div class="followers">
              <span class="count">22.6k</span>
              <span class="text">followers</span>
            </div>
            <div class="avatars">
              <img src="./assets/pic-1.jpg" alt="">
              <img src="./assets/pic-2.jpeg" alt="">
              <img src="./assets/pic-3.jpg" alt="">
              <img src="./assets/user.jpg" alt="">
              <img src="./assets/profile.jpg" alt="">
              <span class="more">8+</span>
            </div>
          </div>
        </div>
        <div class="right">
          <div class="feed-card">
            <div class="feed">
              <img src="./assets/433719638_968658111290327_8362694328875161291_n.jpg" alt="">
              <div class="feed-content">
                <h5>What an amazing day! I love being a doctor!</h5>
                <div class="social-icons">
                  <div class="icon">
                    <i class="fa fa-heart"></i> 12
                  </div>
                  <div class="icon">
                    <i class="fa fa-clock-o"></i> 1h ago
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <div class="feed">
              <img src="./assets/433719638_968658111290327_8362694328875161291_n.jpg" alt="">
              <div class="feed-content">
                <h5>My decision to move from London to NY paid off!</h5>
                <div class="social-icons">
                  <div class="icon">
                    <i class="fa fa-heart"></i> 19
                  </div>
                  <div class="icon">
                    <i class="fa fa-clock-o"></i> 3h ago
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <my-button text="Hello"></my-button>
    <my-button2></my-button2>
    <script>
      class MyButton extends HTMLElement {
        constructor(text) {
          super();
          // this.createTemplate();
        }

        connectedCallback() {
          // console.log("init");
          this.createTemplate();
        }
        disconnectedCallback() {
          console.log("deleted");
        }

        adoptedCallback() {
          console.log("moved");
        }
        
        attributeChangedCallback(name, newValue, oldValue) {
          console.log("changed");
          console.log(name);
          console.log(newValue);
          console.log(oldValue);
        }

        createTemplate() {
          const root = this.attachShadow( {mode: "closed"});
          const template = document.createElement("template");
          const container = document.createElement("div");
          const btn1 = document.createElement("button");
          const btn2 = document.createElement("button");

          btn1.textContent = "Add";
          btn2.textContent = "Delete";
          container.appendChild(btn1);
          container.appendChild(btn2);
          template.innerHTML = container.innerHTML;

          root.appendChild(template.content.cloneNode(true));
        }

        static get observedAttributes() {
          return ["text"];
        }
      }

      window.customElements.define("my-button", MyButton);

      class MyCustomButton extends HTMLButtonElement {
        constructor() {
          self = super();
          self.textContent = "My button";
        }
      }

      window.customElements.define("my-button2", MyCustomButton, {extends: "button"});
    </script>

    <h1 hidden><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1>
    
    <h1 id="title" style="display: none;">Loading...</h1>
    <p id="summary" style="display: none;">Loading...</p>

    <script>
      const DEFAULT_STATE = {
        title: "Example Title", 
        summary: "This is the page summary"
      };

      const state = new Proxy({ ...DEFAULT_STATE }, {
        set(obj, prop, value) {
          console.log(`Property ${prop} is wanting to change to ${value}`);

          obj[prop] = value;

          render(obj);

          return true;
        }
      });

      // state.title = "New Title";
      const render = (state) => {
        document.getElementById("title").textContent = state.title;
        document.getElementById("summary").textContent = state.summary;
      }

      render(state);
      // console.log(state);
    </script>

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

<p style="display: none;">
  pet season
15
complete 150 missions
buy 65 items
<!-- 17 -->
<!-- magic resist glyph -->
<!-- chat -->
<!-- deal 200k damage Camp -->
18
win 5 times with tank in tower
deal 200k damage Camp
5 times first skills Camp
19
500 tower coins
magic power glyph
deal 200k ph.damage arena
exchange 200 items
first skills 30 times arena
20
chat
1500k damage Camp
armor glyph
21
tank hero skills 10
500 tower coins
20 hero soul stones
</p>

    <script>
      const matches4 = `2100`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches4.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>