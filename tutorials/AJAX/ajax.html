<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <style>
      @import url(https://fonts.googleapis.com/css?family=Satisfy|Pathway+Gothic+One);

      * {
        box-sizing: border-box;
      }

      /* Defaults */
      html, 
      body, 
      #quizzie {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }
      
      .hidden {
        display: none;
      }
      
      body {
        background: #677c8a;
        color: #fff;
      }
      
      h1 {
        font-family: 'Satisfy', 'cursive';
        font-size: 2.5em;
      }
      
      h2, p {
        font-family: 'Pathway Gothic One', 'sans-serif';
        font-size: 2em;
      }
      
      h1, h2, p {
        text-align: center;
        display: block;
        width: auto;
        margin: 1%;
      }
      
      #quizzie {
        padding: 5% 0;
        /* Individual Steps/Sections */
        /* Content */
      }
      
      #quizzie ul {
        list-style: none;
        display: block;
        width: auto;
        margin: 2% 2%;
        padding: 2%;
        overflow: auto;
        display: none;
        /* Step Questions and Answer Options */
      }
      
      #quizzie ul.current {
        display: block;
      }
      
      #quizzie ul li {
        display: inline-block;
        float: left;
        width: 49%;
        margin-right: 2%;
        overflow: auto;
        text-align: center;
      }
      
      #quizzie ul li.quiz-answer {
        cursor: pointer;
      }
      
      #quizzie ul li.question, #quizzie ul li.results-inner {
        display: block;
        float: none;
        width: 100%;
        text-align: center;
        margin: 0;
        margin-bottom: 2%;
      }
      
      #quizzie ul li.results-inner {
        padding: 5% 2%;
      }

      #quizzie ul li.results-inner img {
        width: 250px;
      }
      
      #quizzie ul li:last-child {
        margin-right: 0;
      }
      
      #quizzie .question-wrap, #quizzie .answer-wrap {
        display: block;
        padding: 1%;
        margin: 1em 10%;
        -moz-border-radius: 10px;
        -webkit-border-radius: 10px;
        border-radius: 10px;
      }
      
      #quizzie .answer-wrap {
        background: Turquoise;
        -moz-transition: background-color 0.5s ease;
        -o-transition: background-color 0.5s ease;
        -webkit-transition: background-color 0.5s ease;
        transition: background-color 0.5s ease;
      }
      
      #quizzie .answer-wrap:hover {
        background: DarkTurquoise;
      }
    </style>
  </head>
  <body>
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <script>
      window.addEventListener('load', solution);

function solution() {
  const form = document.querySelector("form");
  const previewList = document.querySelector(".preview-list");
  const pendingList = document.querySelector(".pending-list");
  const resolvedList = document.querySelector(".resolved-list");
  // console.log(previewList, pendingList, resolvedList);
  // console.log(form);
  
  const employeeField = document.getElementById("employee");
  const categoryField = document.getElementById("category");
  const urgencyField = document.getElementById("urgency");
  const assignedTeamField = document.getElementById("team");
  const descriptionField = document.getElementById("description");
  // console.log(employeeField, categoryField, urgencyField, assignedTeamField, descriptionField);

  // employeeField.value = "emp";
  // categoryField.value = "cat";
  // urgencyField.value = "ureg";
  // assignedTeamField.value = "team";
  // descriptionField.value = "desc";

  const addBtn = document.getElementById("add-btn");
  // console.log(addBtn);

  addBtn.addEventListener("click", (e) => {
    e.preventDefault();
  
    const employeeFieldValue = employeeField.value;
    const categoryFieldValue = categoryField.value;
    const urgencyFieldValue = urgencyField.value;
    const assignedTeamFieldValue = assignedTeamField.value;
    const descriptionFieldValue = descriptionField.value;
    // console.log(employeeFieldValue, categoryFieldValue, urgencyFieldValue, assignedTeamFieldValue, descriptionFieldValue);

    form.reset();
    const options = document.querySelectorAll("option[selected]");
    Array.from(options).forEach(option => option.selected = false);

    if (employeeFieldValue.length == 0) {
      // console.log("return");
      return;
    }

    if (categoryFieldValue.length == 0) {
      // console.log("return");
      return;
    }

    addBtn.disabled = true;

    const li = document.createElement("li");
    li.classList.add("problem-content");
    const html = `<article><p>From: ${employeeFieldValue}</p><p>Category: ${categoryFieldValue}</p><p>Urgency: ${urgencyFieldValue}</p><p>Assigned to: ${assignedTeamFieldValue}</p><p>Description: ${descriptionFieldValue}</p></article>`;
    li.innerHTML = html;

    const editBtn = document.createElement("button");
    editBtn.classList.add("edit-btn");
    editBtn.textContent = "Edit";
    editBtn.addEventListener("click", () => {
      // console.log("edit");
      addBtn.disabled = false;
      li.remove();
    })

    const contBtn = document.createElement("button");
    contBtn.classList.add("continue-btn");
    contBtn.textContent = "Continue";
    contBtn.addEventListener("click", () => {
      // console.log("continue");
      editBtn.remove();
      contBtn.remove();
      
      const resolvedBtn = document.createElement("button");
      resolvedBtn.classList.add("resolve-btn");
      resolvedBtn.textContent = "Resolved";
      resolvedBtn.addEventListener("click", () => {
        // console.log("resolve");
        resolvedList.appendChild(li);
        resolvedBtn.remove();
        const clearBtn = document.createElement("button");
        clearBtn.classList.add("clear-btn");
        clearBtn.textContent = "Clear";
        clearBtn.addEventListener("click", () => {
          // console.log("resolve");
          li.remove();
        })
        li.appendChild(clearBtn);
      })
      li.appendChild(resolvedBtn);
      pendingList.appendChild(li);
    })
    li.appendChild(editBtn);
    li.appendChild(contBtn);
    previewList.appendChild(li);
    // console.log(document.querySelector(".preview-list > li").length);
  })

}
    </script>

    <script>
      class FlightBookingSystem {
        constructor (agencyName) {
          this.agencyName = agencyName;
          this.flights = [];
          this.bookings = [];
          this.bookingsCount = 0;
        }

        addFlight (flightNumber, destination, departureTime, price) {
          const flight = this.flights.find(flight => flight.flightNumber == flightNumber);

          if (flight) {

            return `Flight ${flight.flightNumber} to ${flight.destination} is already available.`;

          } else {

            const newFlight = {
              flightNumber, 
              destination, 
              departureTime, 
              price
            }

            this.flights.push(newFlight);
            return `Flight ${newFlight.flightNumber} to ${newFlight.destination} has been added to the system.`;

          }
        }

        bookFlight (passengerName, flightNumber) {
          const flight = this.flights.find(flight => flight.flightNumber == flightNumber);
          // console.log(flight);

          if (flight) {

            const booking = {
              passengerName, 
              flightNumber
            }
            
            // console.log(booking);
            this.bookings.push(booking);
            // console.log(this.bookings);
            this.bookingsCount++;
            return `Booking for passenger ${passengerName} on flight ${flightNumber} is confirmed.`;
            
          } else {

            return `Flight ${flightNumber} is not available for booking.`;

          }
        }

        cancelBooking (passengerName, flightNumber) {
          const bookingIndex = this.bookings.findIndex(booking => booking.passengerName == passengerName && booking.flightNumber == flightNumber);
    
          if (bookingIndex >= 0) {
    
            this.bookings.splice(bookingIndex, 1);
            this.bookingsCount--;
            return `Booking for passenger ${passengerName} on flight ${flightNumber} is cancelled.`;
    
          } else {
    
            throw new Error(`Booking for passenger ${passengerName} on flight ${flightNumber} not found.`);
    
          }
        }
          
        showBookings (criteria) {

          if (this.bookings.length == 0) {

            throw new Error(`No bookings have been made yet.`);

          } else {

            if (criteria == "all") {

              const result = [`All bookings(${this.bookingsCount}):`];

              for (const booking of this.bookings) {
                const info = `${booking.passengerName} booked for flight ${booking.flightNumber}.`;
                result.push(info);
              }

              return result.join("\n");

            } else if (criteria == "cheap") {

              const cheapFlights = this.flights.filter(flight => flight.price <= 100);
              // console.log(cheapFlights);

              if (cheapFlights.length > 0) {

                const result = ["Cheap bookings:"];
                
                for (const flight of cheapFlights) {
                  const flightNumber = flight.flightNumber;
                  const cheapBookings = this.bookings.filter(booking => booking.flightNumber == flightNumber);

                  for (const passenger of cheapBookings) {
                    
                    const info = `${passenger.passengerName} booked for flight ${flightNumber}.`;
                    result.push(info);

                  }
                }
                
                return result.join("\n");

              } else {

                return "No cheap bookings found.";

              }
              
            } else if (criteria == "expensive") {

              const expensiveFlights = this.flights.filter(flight => flight.price > 100);
              
              if (expensiveFlights.length > 0) {
                
                const result = ["Expensive bookings:"];
                
                for (const flight of expensiveFlights) {
                  const flightNumber = flight.flightNumber;
                  const expensiveBookings = this.bookings.filter(booking => booking.flightNumber == flightNumber);
                  
                  for (const passenger of expensiveBookings) {
                    
                    const info = `${passenger.passengerName} booked for flight ${flightNumber}.`;
                    result.push(info);
                    
                  }
                }
                
                return result.join("\n");
                
              } else {
                
                return "No expensive bookings found.";
                
              }

            }
          }
        }
      }

      // const system = new FlightBookingSystem("TravelWorld");
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 250));
      // console.log(system.addFlight("BB202", "New York", "10:30 AM", 180));
      // console.log(system.addFlight("CC303", "Chicago", "11:45 AM", 120));
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 250));

      // const system = new FlightBookingSystem("TravelWorld");
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 250));
      // console.log(system.addFlight("BB202", "New York", "10:30 AM", 180));
      // console.log(system.bookFlight("Alice", "AA101"));
      // console.log(system.bookFlight("Bob", "BB202"));
      // console.log(system.bookFlight("Charlie", "CC303"));
      
      // const system = new FlightBookingSystem("TravelWorld");
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 250));
      // console.log(system.addFlight("BB202", "New York", "10:30 AM", 180));
      // console.log(system.bookFlight("Alice", "AA101"));
      // console.log(system.bookFlight("Bob", "BB202"));
      // console.log(system.bookings);
      // console.log(system.bookingsCount);
      // console.log(system.cancelBooking("Alice", "AA101"));
      // console.log(system.bookings);
      // console.log(system.bookingsCount);
      
      // const system = new FlightBookingSystem("TravelWorld");
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 250));
      // console.log(system.addFlight("BB202", "New York", "10:30 AM", 180));
      // console.log(system.bookFlight("Alice", "AA101"));
      // console.log(system.bookFlight("Bob", "BB202"));
      // console.log(system.showBookings("all"));

      // const system = new FlightBookingSystem("TravelWorld");
      // console.log(system);
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 250));
      // console.log(system.addFlight("BB202", "New York", "10:30 AM", 180));
      // console.log(system.addFlight("AA101", "Los Angeles", "09:00 AM", 50));
      // console.log(system.addFlight("BB202", "New York", "10:30 AM", 80));
      // console.log(system.bookFlight("Alice", "AA101"));
      // console.log(system.bookFlight("Bob", "BB202"));
      // console.log(system.bookings);
      // console.log(system.showBookings("expensive"));
      // console.log(system.showBookings("cheap"));
    </script>

<script>
  // 10. Contacts Builder✶
  // 11. View Model✶
  // 12. Payment Package
  // 13. String Builder *✶
</script>

    <!-- ================= Get data from local JSON file ================= -->

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>