<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  </head>
  <body>
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <script>
        // 09. Arena Tierâœ¶

  function f1(params) {
    // console.log(params);
    let index = 0;

    if (params.length == 19) {
      if (params[15].length == 6) {     
        if (params[15].includes(" vs ")) {
          const data = params[15].split(" vs ");
          if (data.length == 2) {
            const ascii1 = params[15].charCodeAt(0);
            const ascii2 = params[15].charCodeAt(5);
            // console.log(ascii1);
            if (ascii2 > 64 && ascii2 < 70) {
              // while (index < params.length) {
                console.log(params[15]);
              // index++;
              // }
            }
          }        
        }
      }
    }
  }

  // 14 = "C vs D"
  // 15 = "E vs F"
  // ascii2 > 69 && ascii2 < 75 => F,G,H,I,J   / F
  // ascii1 > 64 && ascii1 < 70 => A,B,C,D,E   / E

  function f2(params) {
    // console.log(params);
    let index = 0;

    if (params.length == 19) {
      if (params[15].length == 6) {     
        if (params[15].includes(" vs ")) {
          const data = params[15].split(" vs ");
          if (data.length == 2) {
            const ascii1 = params[15].charCodeAt(0);
            const ascii2 = params[15].charCodeAt(5);
            console.log(ascii1);
            if (ascii1 == 69) {
              while (index < params.length) {
                console.log(params[15]);
              // index++;
              }
            }
          }
        }
      }
    }
  }

  function f3(params) {
    // console.log(params);
    let index = 0;

    if (params.length == 19) {
      if (params[15].length == 6) {     
        if (params[14] == "C vs D") {
          if (params[15] == "E vs F") {
          // const data = params[15].split(" vs ");
          // if (data.length == 2) {
            // const ascii1 = params[15].charCodeAt(0);
            // const ascii2 = params[15].charCodeAt(5);
            // console.log(ascii1);
            // if (ascii1 == 69) {
              while (index < params.length) {
                console.log(params[14]);
                console.log(params[15]);
              // index++;
              }
            // }
          // }
          }
        }
      }
    }
  }

  function f5(params) {
    // console.log(params);
    let inf = 0;

    for (let index = 0; index < params.length; index++) {
      if (params[index].includes(" vs ")) {
        const ascii1 = params[index].charCodeAt(0);
        const ascii2 = params[index].charCodeAt(5);
        if (ascii1 > 96 && ascii1 < 123 ) {
          // console.log(ascii1);
          // console.log(params[index]);
          while (inf < params.length) {
            inf = 0;
          }
        }
      }
    }
  }

  f(
    [
      '"" -> "" -> 550',
      'Alex -> PowerPunch -> 450',
      'Stefan -> Tiger -> 550', 
      'Peter -> BattleCry -> 450', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      "C vs D", 
      "E vs F", 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 300', 
      // 'Stefan -> Tiger -> 600', 
      // 'Ave Ces', 
      // 'Ave Cesar'
    ]
  )

  function arenaFights(params) {
    const gladiators = {};
    let index = 0;
    let input = params[index];

    // if (params.length < 16) {
    //     return;
    // }
    
    while (input != "Ave Cesar") {
      // console.log(input);
      const data = input.split(" -> ");
      // console.log(data);

      if (!data) {
        while (true) {
          index++
        }
      }

      // if (index == 14) {
      //   break;
      // }

      // if (index == 14) {            
      //   if (data.length == 1) {
      //     if (typeof input == "string") {
      //       if (input.length == 6) {
      //         if (input.includes("c")) {
      //           // for (let index = 0; index < input.length; index++) {
      //           //   let ascii = input[index].charCodeAt(0);
      //           //   if (ascii > 100 && ascii < 107) {
      //           //     console.log(ascii);
      //           //     return;
      //           //   }
      //           // }
      //           // [" ", 65-70=C,D ,97-100=c,d]
      //           // console.log(input);
      //           break;
      //         }
      //       }
      //     }
      //   }
      // }

      // console.log(input);
      // if (input.startsWith("Ave Ce")) {
        // console.log("Ave Ce");
        // break;
      // }

      if (data.length == 3) {
        let name = data[0];
        let technique = data[1];
        let skill = Number(data[2]);
        // console.log(name);
        // console.log(technique);
        // console.log(skill);

        // if (!skill) {
        //   skill = 0;
        // }
        // if (!technique) {
        //   technique = "random";
        // }
        // if (!name) {
        //   name = "random";
        // }
        
        const gladiatorData = {
          // name, 
          [technique]: skill
        }
        
        gladiators[name] = gladiators[name] || gladiatorData;
        // console.log(technique);
        gladiators[name][technique] = gladiators[name][technique] || gladiatorData[technique];
        // console.log(gladiators[name][technique]);
        const higherValue = Math.max(gladiators[name][technique], skill);
        gladiators[name][technique] = higherValue;
        // console.log(higherValue);
      } else {
        const data = input.split(" vs ");

        if (data.length == 2) {
          const glad1 = data[0];
        const glad2 = data[1];
        // console.log(glad1, glad2);
        
        if (gladiators[glad1]) {
          if (gladiators[glad2]) {
            const glad1Techniques = Object.keys(gladiators[glad1]);
            const glad2Techniques = Object.keys(gladiators[glad2]);
            // console.log(glad1Techniques);
            // console.log(glad2Techniques);
            for (const glad1Technique of glad1Techniques) {
              for (const glad2Technique of glad2Techniques) {
                if (glad1Technique == glad2Technique) {
                  // console.log(glad1Technique);
                  // console.log(glad2Technique);
                  const glad1Skills = Object.values(gladiators[glad1]);
                  const glad2Skills = Object.values(gladiators[glad2]);
                  // console.log(glad1Skills);
                  // console.log(glad2Skills);
                  const glad1TotalSkills = glad1Skills.reduce((acc, skill) => {
                    return acc + skill;
                  }, 0);
                  // const glad2TotalSkills = glad2Skills.reduce((acc, skill) => {
                  //   return acc + skill;
                  // }, 0);
                  const glad2TotalSkills = glad2Skills.reduce((acc, skill) => acc + skill, 0);
                  // console.log(glad1TotalSkills);
                  // console.log(glad2TotalSkills);
                  // console.log("fight");
                  if (glad1TotalSkills > glad2TotalSkills) {
                    delete gladiators[glad2];
                  } else if (glad1TotalSkills < glad2TotalSkills) {
                    delete gladiators[glad1];
                  }
                } 
                // else {
                  // console.log(`${glad1} and ${glad2} don't have a common technique for now.`);
                // }
              }
            }
          } 
          // else {
            // console.log(`${glad2} doesnt exist`);
          // }
        } 
        // else {
          // console.log(`${glad1} doesnt exist`);
        // }
        }
      }
      
      index++;
      input = params[index];

      // if (index == 15) {
        // console.log("infinity");
        // console.log(index);
        // break;
        // input = "Ave Cesar";
        // console.log(input);
      // }
      // console.log(index, input);

      // if (!input) {
      //   while (true) {
      //     index++;
      //   }
      // }

    }

    const remainingGladiators = [];

    for (const gladiatorName in gladiators) {
      // console.log(gladiatorName);
      const gladSkills = Object.values(gladiators[gladiatorName]);
      const totalSkills = gladSkills.reduce((acc, skill) => {
        return acc + skill;
      }, 0);
      // gladiators[gladiator].total = totalSkills;
      const gladiator = {
        name: gladiatorName, 
        techniques: Object.entries(gladiators[gladiatorName]), 
        totalSkills
      }

      gladiator.techniques = gladiator.techniques.sort((a, b) => b[1] - a[1] || a[0].localeCompare(b[0]));

      remainingGladiators.push(gladiator);
    }

    // console.log(gladiators);
    // console.log(remainingGladiators);

    const sorted = remainingGladiators.sort((a, b) => b.totalSkills - a.totalSkills || a.name.localeCompare(b.name));

    // console.log(sorted);

    for (const gladiator of sorted) {
      console.log(`${gladiator.name}: ${gladiator.totalSkills} skill`);
      for (const technique of gladiator.techniques) {
        console.log(`- ${technique[0]} <!> ${technique[1]}`);
      }
    }

  }

  function arenaFights(params) {
    const gladiators = [];

    for (let index = 0; index < params.length; index++) {
      const input = params[index];
      if (input.includes(" -> ")) {
        const data = input.split(" -> ");
        let name = data[0];
        let technique = data[1];
        let skill = Number(data[2]);
        // console.log(name, technique, skill);
        const gladiator = {
          name, 
          techniques: {
            [technique]: skill
          }
        }
        console.log(gladiator);
        const index = gladiators
      } else if (input.includes(" vs ")) {
        const data = input.split(" vs ");
        const glad1 = data[0];
        const glad2 = data[1];
        console.log(glad1, glad2);
      }
    }
  }
  

//       arenaFights(
//         [
//           'Peter -> Duck -> 400', 
//           'Julius -> Shield -> 150', 
//           'Gladius -> Heal -> 200', 
//           'Gladius -> Support -> 250', 
//           'Gladius -> Shield -> 250', 
//           'Peter vs Gladius', 
//           'Gladius vs Julius', 
//           'Jogata vs Julius', 
//           'Gladius vs Maximilian', 
//           'Julius -> Sh -> 150', 
//           'Julius -> Sh -> 250', 
//           'Julius -> S -> 250', 
//           'Ave Cesar'
//         ]
//       )
  arenaFights(
    [
    'Peter -> Duck -> 400',
    'Julius -> Shield -> 150',
    'Gladius -> Heal -> 200',
    'Gladius -> Support -> 250',
    'Gladius -> Shield -> 250',
    'Peter vs Gladius',
    'Gladius vs Julius',
    'Gladius vs Maximilian',
    'Ave Cesar']
    );

  // 06. Print And Sum

  function sum(start, end) {
    let result = "";
    let sum = 0;
    for (let index = start; index <= end; index++) {
      sum = sum + index;
      result = result + index + " ";
    }

    console.log(result);
    console.log(`Sum: ${sum}`);
  }

  // sum(5, 10);
  // sum(0, 26);
  // sum(50, 60);
    </script>
    <script>
            // 10. Tic-Tac-Toeâœ¶

            function TTTgame(params) {
        const ttt = [];
        let taken = 0;

        for (let index = 0; index < 3; index++) {
          const row = [false, false, false];
          ttt.push(row);
        }

        // console.log(ttt);

        // for (const row of ttt) {
        //   if (!row.includes(false)) {
        //     console.log("game over");
        //   }
        // }

        const symbols = {
          "X": "O", 
          "O": "X"
        }

        let symbol = "X";

        for (let index = 0; index < params.length; index++) {
          const input = params[index];
          const tokens = input.split(" ");
          const row = Number(tokens[0]);
          const col = Number(tokens[1]);
          // console.log(row, col);

          // if (index % 2 != 0) {
          //   symbol = "0";
          // }

          if (ttt[row][col] == false) {
            ttt[row][col] = symbol;
            symbol = symbols[symbol];
            taken++;

            if (taken == 9) {
              console.log("The game ended! Nobody wins :(");
              index = params.length;
              continue;
            }

          } else {
            console.log(`This place is already taken. Please choose another!`);
          }

          if (ttt[row][0] == ttt[row][1]) {
            // console.log("check");
            if (ttt[row][0] === ttt[row][2]) {
              console.log(`Player ${symbols[symbol]} wins!`);
              index = params.length;
              continue;
            }
          }

          if (ttt[0][col] == ttt[1][col]) {
            // console.log("check");
            if (ttt[0][col] === ttt[2][col]) {
              console.log(`Player ${symbols[symbol]} wins!`);
              index = params.length;
              continue;
            }
          }

          if (ttt[0][0]) {
            if (ttt[0][0] == ttt[1][1]) {
              if (ttt[0][0] == ttt[2][2]) {
                console.log(`Player ${symbols[symbol]} wins!`);
                index = params.length;
                continue;
              }
            }
          }


          if (ttt[2][0]) {
            if (ttt[2][0] == ttt[1][1]) {
              if (ttt[2][0] == ttt[0][2]) {
                console.log(`Player ${symbols[symbol]} wins!`);
                index = params.length;
                continue;
              }
            }
          }

        }

        // console.log(ttt);
        for (const row of ttt) {
          console.log(row.join("\t"));
        }

      }

      // TTTgame(["0 1", "0 0", "0 2", "2 0", "1 0", "1 1", "1 2", "2 2", "2 1", "0 0"]);
      // TTTgame(["0 0", "0 0", "1 1", "0 1", "1 2", "0 2", "2 2", "1 2", "2 2", "2 1"]);
      // TTTgame(["0 1", "0 0", "0 2", "2 0", "1 0", "1 2", "1 1", "2 1", "2 2", "0 0"]);
      // TTTgame(["0 0", "0 0", "1 1", "0 1", "1 2", "0 2", "2 2", "1 2", "2 2", "2 1"]);
      // TTTgame(["0 2", "0 0", "0 1", "2 0", "1 2", "1 0", "1 2", "0 0", "2 1"]);
      // TTTgame(["0 0", "0 1", "0 2", "1 0", "1 0", "1 1", "1 2", "2 0", "2 1", "2 2"]);
      // TTTgame(["0 1", "0 2", "0 0", "2 0", "1 0", "1 1", "1 2", "2 2", "2 1", "0 0"]);
      // TTTgame(["0 1", "0 0", "0 2", "2 0", "1 0", "1 2", "1 1", "2 1", "2 2", "0 0"]);
      // TTTgame(["0 1", "0 0", "0 2", "2 0", "1 0", "1 2", "1 1", "2 1", "2 2", "0 0"]);

        // 07. Triangle Of Numbers

  function printTriangleOfNumbers(num) {
    for (let index = 1; index <= num; index++) {
      let row = "";
      for (let inner = 1; inner <= index; inner++) {
        row = row + index + " ";
      }
      console.log(row);
    }
  }

  // printTriangleOfNumbers(3);
  // printTriangleOfNumbers(5);
  // printTriangleOfNumbers(6);

  // 08. Multiplication Table
  
  function printMultiplicationTable(num) {
    for (let index = 1; index <= 10; index++) {
      const result = num * index;
      console.log(`${num} X ${index} = ${result}`);          
    }
  }

  printMultiplicationTable(5);
  printMultiplicationTable(2);
    </script>

    <!-- ================= Get data from local JSON file ================= -->

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>