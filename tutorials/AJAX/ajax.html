<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="container gallery">
      <div class="heading">
        <h3>photo <span>gallery</span></h3>
      </div>
      <div class="box">
        <div class="dream">
          <img src="../../../CSS/assets/img/alley-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/branch-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/clouds-bg-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/foggy-lake-quang-nguyen-vinh-2166695-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/forest.jpg" alt="">
        </div>
        <div class="dream">
          <img src="../../../CSS/assets/img/games-the-elder-scrolls-v-skyrim-50003-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/girl-winter-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/lake-17401.jpg" alt="">
          <img src="../../../CSS/assets/img/miao-gengxin-gu435nBTLW4-unsplash.jpg" alt="">
          <img src="../../../CSS/assets/img/pexels-alex-azabache-3879055.jpg" alt="">
        </div>
        <div class="dream">
          <img src="../../../CSS/assets/img/rainforest-kunal-shinde--f0YLss50Bs-unsplash.jpg" alt="">
          <img src="../../../CSS/assets/img/river-bank-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/road-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/scenic-view-of-lake-against-sky-during-sunset-copy.jpg" alt="">
          <img src="../../../CSS/assets/img/stadium-bg.jpg" alt="">
        </div>
      </div>
      <div class="btn">
        <a href="#">more</a>
      </div>
    </div>

    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <!-- ================= Get data from local JSON file ================= -->
    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      async function updateUser(baseURL, id, data, apiKey) {
  const fullURL = `${baseURL}/${id}`
  await fetch(fullURL, {
    method: 'PUT',
    mode: 'cors',
    headers: {
      'X-API-Key': apiKey,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
  })
}

async function getUserById(baseURL, id, apiKey) {
  const fullURL = `${baseURL}/${id}`
  const response = await fetch(fullURL, {
    method: 'GET',
    mode: 'cors',
    headers: {
      'X-API-Key': apiKey,
      'Content-Type': 'application/json'
    }
  })
  return response.json()
}

// don't touch below this line

const userId = '2f8282cb-e2f9-496f-b144-c0aa4ced56db'
const generatedKey = generateKey()
const baseURL = 'https://api.boot.dev/v1/courses_rest_api/learn-http/users'

function generateKey() {
  const characters = 'ABCDEF0123456789'
  let result = ''
  for (let i = 0; i < 16; i++) {
    result += characters.charAt(Math.floor(Math.random() * characters.length))
  }
  return result
}

function logUser(user) {
  console.log(`User uuid: ${user.id}, Character Name: ${user.characterName}, Class: ${user.class}, Level: ${user.level}, PVP Status: ${user.pvpEnabled}, User name: ${user.user.name}`)
}

const start = async function () {
  const userData = await getUserById(baseURL, userId, generatedKey)
  logUser(userData);
  console.log(`Updating user with id: ${userId}`)
userData.characterName = 'Dellbiar'
userData.level = 7
userData.class = 'Warrior'
userData.pvpEnabled = true
userData.user.name = 'Allan'
await updateUser(baseURL, userId, userData, generatedKey)

const newUser = await getUserById(baseURL, userId, generatedKey)
logUser(newUser) 
}

start();
    </script>

    <script>
            // 10. Profit

            function magic1(params) {
        const b1 = Number(params[0]);
        const b2 = Number(params[1]);
        const b5 = Number(params[2]);
        const sum = Number(params[3]);

        for (let leva1 = 0; leva1 <= b1; leva1++) {
          let sum1 = 0;
          sum1+=leva1;

          for (let leva2 = 0; leva2 <= b2; leva2++) {
            let sum2 = 0;
            sum2+=leva2*2;

            for (let leva5 = 0; leva5 <= b5; leva5++) {
              let sum5 = 0;
              sum5+=leva5*5;

              // console.log(sum1, sum2, sum5);

              const currentSum = sum1 + sum2 + sum5;
              if (currentSum === sum) {
                console.log(`${leva1} * 1 lv. + ${leva2} * 2 lv. + ${leva5} * 5 lv. = ${sum} lv.`);
              }

            }
          }
        }
      }

      // magic1(["3", "2", "3", "10"]);
      // magic1(["5", "3", "1", "7"]);
    </script>
  </body>
</html>