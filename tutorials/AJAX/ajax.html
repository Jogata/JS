<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AJAX | XMLHttpRequest</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Monoton&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Julee&display=swap');

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;   
      }

      body {
        margin: 0; 
        place-items: center;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
        background-image: url("./static/img/zero.jpg");
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-size: cover;
      }
      
      #wrapper {
          margin: 2.35rem 0 0;
          display: flex;
          gap: 25px;
          justify-content: center;
          /* justify-content: center; */
      }
      
      #start>h1 {
          margin-top: 80px;
          color:rgb(255, 255, 255);
          font-size: 3rem;
          font-weight: 500;
          text-align: center;
          font-family: 'Monoton', cursive;
          letter-spacing: 0.1rem;
          text-shadow: 2px 2px black;
          -webkit-background-clip: text;
          background-clip: text;
      }
      
      #start {
          display: flex;
          align-items: center;
          justify-content: center;
      }
      
      img {
          width: 5rem;
      }
      
      .home-container {
          height: 1rem;
          margin: 0px auto 4px 0;
          top: 0%;
          left: 50%;
          display: flex;
          text-align: center;
      }
      
      .info {
          position: relative;
          margin-top: 8rem;
          flex: 1;
          display: flex;
          flex-direction: column;
          justify-items: legacy;
      }
      
      .info > h1 {
          position: relative;
          margin: -9.3rem 0 0px;
          padding: 0;
          color: rgb(242, 238, 213);
          font-size: 2rem;
          font-weight: 300;
          font-family: 'Monoton', cursive;
          text-transform: uppercase;
          letter-spacing: 0px;
      }
      
      .section-container {
          grid-template-columns: 1fr 1fr;
          width: 30vw;
          height: 58vh;
          display: flex;
          align-items:center;
          justify-content:baseline;
          flex-direction: column;
          place-items: center;
          border-radius: 10px;
          font-family: 'Julee', cursive;
          background-color:  rgb(235, 232, 223);
          box-shadow: 
          rgba(0, 0, 0, 0.06) 0px 2px 1px, 
          rgba(0, 0, 0, 0.09) 0px 4px 2px, 
          rgba(0, 0, 0, 0.09) 0px 8px 4px, 
          rgba(0, 0, 0, 0.09) 0px 16px 8px, 
          rgba(0, 0, 0, 0.09) 0px 32px 16px,
          rgba(0, 0, 0, 0.17) 0px -23px 25px 0px inset, 
          rgba(0, 0, 0, 0.15) 0px -36px 30px 0px inset, 
          rgba(0, 0, 0, 0.1) 0px -79px 40px 0px inset;
          opacity: 0.95;
      }
      
      .section-container > h1 {
        background-color:  rgb(235, 232, 223);
        opacity: 0.95;
        padding: 0.25rem 0rem;
        /* margin-right: 5rem; */
        border-radius: 10px 10px 0 0;
        border-bottom: 3px groove #000000;
        font-size: 1.5rem;
        font-weight: 600;
      }
      
      .container-text {
          display: flex;
          flex-direction: column;
          align-items: center;
      }
      
      .container-text > form {
          padding: 1rem;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          margin-right: -25px;
      }
    </style>
  </head>
  <body id="body">
    <!-- <h1><span>AJAX</span> XMLHttpRequest(HTTPMethod, url, )</h1> -->

    <div id="main">

      <section id="start">
          <img src="./static/img/dumbell.png" alt="">
          <h1>Start Your Fitness Journey with Us</h1>
          <img src="./static/img/dumbell.png" alt="">
      </section>
      
      <div id="wrapper">
  
          <section id="info-section">
              <div class="section-container"> 
                               
                  <h1>Pick Class</h1>
                  
                  <div class="container-text">
                      <form action="">
                          <label for="name">Name:</label>
                          <input type="text" id="name" name="name">
  
                          <label for="email">Email:</label>
                          <input type="text" id="email" name="email">                     
  
                              <label for="contact-number">Contact Number:</label>
                              <input type="number" id="contact-number" name="contact-number" >
  
                              <label for="Preferred Class Type">Preferred Class Type:</label>
                              <select type="" id="class-type" name="class-type">
                                  <option value=""></option>
                                  <option value="Yoga" selected>Yoga</option>
                                  <option value="Zumba">Zumba</option>
                                  <option value="Kango Jumps">Kango Jumps</option>
                                  <option value="Pilates">Pilates</option>
                              </select>
                              <label for="class-time">Preferred Class Time:</label>
                              <select type="" id="class-time" name="class-time">
                                  <option value=""></option>
                                  <option value="17:00">17:00</option>
                                  <option value="18:00">18:00</option>
                                  <option value="19:00">19:00</option>
                                  <option value="20:00">20:00</option>
                              </select>
                              
                          <button id="next-btn" type="submit">Next</button>
                      </form>
                      
                  </div>
              </div>
          </section>
  
          <section id="preview-section">
              <div class="preview-info-container">
                  <div class="section-container"> 
                  <h1>Preview</h1>
                  <ul class="class-info">
                  </ul>
              </div>
              </div>
          </section>
  
          <section id="confirm-section">
              <div class="confirm-container">
                  <div class="section-container"> 
                  <h1>Confirm Class</h1>
                  <ul class="confirm-class">
                  </ul>
              </div>
              </div>
          </section>
          
      </div>
      
    </div>
    
    <footer>
      <p>Exam @ SoftUni</p>
    </footer>

    <script>
      window.addEventListener('load', solve);
  
  function solve() {
      const form = document.querySelector("form");
      const previewList = document.querySelector(".class-info");
      const confirmList = document.querySelector(".confirm-class");
      // console.log(previewList, confirmList);
  
      const nameField = document.getElementById("name");
      const emailField = document.getElementById("email");
      const contactField = document.getElementById("contact-number");
      const classField = document.getElementById("class-type");
      const timeField = document.getElementById("class-time");
      // console.log(nameField, emailField, contactField, classField, timeField);
  
      // nameField.value = "testName";
      // emailField.value = "test@abv.bg";
      // contactField.value = "";
      // classField.value = "";
      // timeField.value = "";
  
      const nextBtn = document.getElementById("next-btn");
      // console.log(nextBtn);
  
      nextBtn.addEventListener("click", (e) => {
          e.preventDefault();
  
          const nameFieldValue = nameField.value;
          const emailFieldValue = emailField.value;
          const contactFieldValue = contactField.value;
          const classFieldValue = classField.value;
          const timeFieldValue = timeField.value;
          // console.log(nameFieldValue, emailFieldValue, contactFieldValue, classFieldValue, timeFieldValue);
          // console.log(contactFieldValue.length);
  
          if (nameFieldValue.length == 0) {
              console.log("name is empty");
              return;
          }
  
          if (emailFieldValue.length == 0) {
              console.log("email is empty");
              return;
          }
  
          if (contactFieldValue.length.toString() == 0) {
              console.log("number is empty");
              return;
          }
  
          if (classFieldValue.length == 0) {
              console.log("class is empty");
              return;
          }
  
          if (timeFieldValue.length == 0) {
              console.log("time is empty");
              return;
          }
  
          form.reset();
          nextBtn.disabled = true;
  
          const selected = document.querySelectorAll("option[selected]");
          Array.from(selected).forEach(option => option.selected = false);
  
          const li = document.createElement("li");
          li.classList.add("info-item");
          const html = `<article class="personal-info"><p>${nameFieldValue}</p><p>${emailFieldValue}</p><p>${contactFieldValue}</p><p>${classFieldValue}</p><p>${timeFieldValue}</p></article>`;
          li.innerHTML = html;
  
          const editBtn = document.createElement("button");
          editBtn.classList.add("edit-btn");
          editBtn.textContent = "Edit";
          editBtn.addEventListener("click", () => {
            // console.log("edit");
            nextBtn.disabled = false;
            li.remove();
          })
  
          const contBtn = document.createElement("button");
          contBtn.classList.add("continue-btn");
          contBtn.textContent = "Continue";
          contBtn.addEventListener("click", () => {
              // console.log("continue");
              editBtn.remove();
              contBtn.remove();
  
              li.className = "continue-info";
  
              const cancelBtn = document.createElement("button");
              cancelBtn.classList.add("cancel-btn");
              cancelBtn.textContent = "Cancel";
              cancelBtn.addEventListener("click", () => {
                  li.remove();
                  nextBtn.disabled = false;
              })
              li.appendChild(cancelBtn);
  
              const confirmBtn = document.createElement("button");
              confirmBtn.classList.add("confirm-btn");
              confirmBtn.textContent = "Confirm";
              confirmBtn.addEventListener("click", () => {
                // console.log("confirm");
                const main = document.getElementById("main");
                main.remove();
                const h1 = document.createElement("h1");
                h1.id = "thank-you";
                h1.textContent = "Thank you for scheduling your appointment, we look forward to seeing you!";
                const doneBtn = document.createElement("button");
                doneBtn.id = "done-btn";
                doneBtn.textContent = "Done";
                document.body.appendChild(h1);
                document.body.appendChild(doneBtn);
              })
              li.appendChild(confirmBtn);
              confirmList.appendChild(li);
            })
          li.appendChild(editBtn);
          li.appendChild(contBtn);
          previewList.appendChild(li);
      });
  }
    </script>

    <script>
      const recipeSelection = {
        isTypeSuitable(type, dietaryRestriction) {

          if (typeof type !== "string" || typeof dietaryRestriction !== "string"){
            throw new Error("Invalid input");
          }

          if (dietaryRestriction === "Vegetarian" && type === "Meat") {
            return "This recipe is not suitable for vegetarians";
          } else if (dietaryRestriction === "Vegan" && (type === "Meat" || type === "Dairy")) {
            return "This recipe is not suitable for vegans";
          } else {
            return "This recipe is suitable for your dietary restriction";
          }
        },
        isItAffordable(price, budget) {

          if (typeof price !== "number" || typeof budget !== "number") {
            throw new Error("Invalid input");
          }
      
          let remainingBudget = budget - price;
      
          if (remainingBudget < 0) {
            return "You don't have enough budget to afford this recipe";
          } else {
            return `Recipe ingredients bought. You have ${remainingBudget}$ left`;
          }
        },
        getRecipesByCategory(recipes, category) {

          if (!Array.isArray(recipes) || typeof category !== "string") {
            throw new Error("Invalid input");
          }
      
          const filteredRecipes = recipes.filter((recipe) => recipe.category === category);

          return filteredRecipes.map((recipe) => recipe.title);

        },
      };
        
      // describe('test recipeSelection', function () {
      //     it('isTypeSuitable functionality', function () {
      //         expect(recipeSelection.isTypeSuitable("Meat", "Vegetarian")).to.equal("This recipe is not suitable for vegetarians");
      //         expect(recipeSelection.isTypeSuitable("Meat", "Vegan")).to.equal("This recipe is not suitable for vegans");
      //         expect(recipeSelection.isTypeSuitable("food", "restriction")).to.equal("This recipe is suitable for your dietary restriction");
      //         expect(() => recipeSelection.isTypeSuitable("test", 8)).to.throw("Invalid input");
      //         expect(() => recipeSelection.isTypeSuitable(6, "test")).to.throw("Invalid input");
      //     })
      //     it('isItAffordable functionality', function () {
      //         expect(recipeSelection.isItAffordable(8, 4)).to.equal("You don't have enough budget to afford this recipe");
      //         expect(recipeSelection.isItAffordable(4, 8)).to.equal("Recipe ingredients bought. You have 4$ left");
      //         expect(recipeSelection.isItAffordable(8, 8)).to.equal("Recipe ingredients bought. You have 0$ left");
      //         expect(() => recipeSelection.isItAffordable("test", 8)).to.throw("Invalid input");
      //         expect(() => recipeSelection.isItAffordable(8, "test")).to.throw("Invalid input");
      //     })
      //     it('getRecipesByCategory functionality', function () {
      //         expect(recipeSelection.getRecipesByCategory([], "Asian")).to.deep.equal([]);
      //         expect(recipeSelection.getRecipesByCategory([{title: "Food1", category: "Asian"}, {title: "Food2", category: "Asian"}], "Asian")).to.deep.equal(["Food1", "Food2"]);
      //         expect(recipeSelection.getRecipesByCategory([{title: "Food1", category: "Asian"}, {title: "Food2", category: "Asian"}, {title: "Food3", category: "African"}], "Asian")).to.deep.equal(["Food1", "Food2"]);
      //         expect(recipeSelection.getRecipesByCategory([{title: "Food3", category: "African"}], "Asian")).to.deep.equal([]);
      //         expect(() => recipeSelection.getRecipesByCategory({}, "")).to.throw("Invalid input");
      //         expect(() => recipeSelection.getRecipesByCategory([], 7)).to.throw("Invalid input");
      //     })
      // })
    </script>

    <script>
      class InventoryManager {
        constructor(capacity) {
            this.capacity = capacity;
            this.items = [];
            this.outOfStock = [];
        }

        addItem(itemName, quantity) {

          
          if (quantity <= 0) {
              throw new Error("Quantity must be greater than zero.");
          }
          
          if (this.capacity <= this.items.length) {
              throw new Error("The inventory is already full.");
          }
          
          const itemIndex = this.items.findIndex(item => item.itemName == itemName);
          
          if (itemIndex >= 0) {
          
              this.items[itemIndex].quantity += quantity;
          
          } else {
          
              const newItem = {
                  itemName, 
                  quantity
              }
          
              this.items.push(newItem);
          
          }
          
          return `Added ${quantity} ${itemName}(s) to the inventory.`;
          
          }
          
          sellItem(itemName, quantity) {
          
          if (quantity <= 0) {
              throw new Error("Quantity must be greater than zero.");
          }
          
          const itemIndex = this.items.findIndex(item => item.itemName == itemName);
          
          if (itemIndex < 0) {
              throw new Error(`The item ${itemName} is not available in the inventory.`);
          }
          
          const item = this.items[itemIndex];
          
          if (item.quantity < quantity) {
              throw new Error(`Not enough ${itemName}(s) in stock.`);
          }
          
          item.quantity -= quantity;
          
          if (item.quantity == 0) {
              this.outOfStock.push(item);
              this.items.splice(itemIndex, 1);
          }
          // console.log(this.items);
          
          return `Sold ${quantity} ${itemName}(s) from the inventory.`;
          
          }
          
          restockItem(itemName, quantity) {
          
          if (quantity <= 0) {
              throw new Error("Quantity must be greater than zero.");
          }
          
          // if (this.capacity <= this.items.length) {
          //     throw new Error("The inventory is already full.");
          // }
          
          const itemIndex = this.items.findIndex(item => item.itemName == itemName);
          const outOfStockIndex = this.outOfStock.findIndex(item => item.itemName == itemName);
          
          if (outOfStockIndex >= 0) {
              this.outOfStock.splice(outOfStockIndex, 1);
          }
          
          if (itemIndex >= 0) {
          
              this.items[itemIndex].quantity += quantity;
          
          } else {
          
              const newItem = {
                  itemName, 
                  quantity
              }
          
              this.items.push(newItem);
          
          }
          
          return `Restocked ${quantity} ${itemName}(s) in the inventory.`;
          
          }
          
          getInventorySummary() {
          
          const result = ["Current Inventory:"];
          
          for (const item of this.items) {
              // console.log(item);
              result.push(`${item.itemName}: ${item.quantity}`)
          }
          
          if (this.outOfStock.length > 0) {
          
              const outOfStockItems = [];
          
              for (const item of this.outOfStock) {
                  // console.log(item);
                  outOfStockItems.push(item.itemName);
              }
          
              const outOfStockItemsAsString = `Out of Stock: ${outOfStockItems.join(", ")}`;
          
              result.push(outOfStockItemsAsString);
          
          }
          
          return result.join("\n");
          
        }
      }

      // const manager = new InventoryManager(2);
      
      // console.log(manager.addItem("Drill", 10));
      // console.log(manager.addItem("Hammer", 5));
      // console.log(manager.addItem("Level", 3));
    </script>
<script>
  // 10. Contacts Builder✶
  // 11. View Model✶
  // 12. Payment Package
  // 13. String Builder *✶
</script>

    <!-- ================= Get data from local JSON file ================= -->

    <fieldset>
      <legend>Get all users from local JSON file</legend>
      <button id="local">Send Request</button>
    </fieldset>

    <script>
      const btnLocalJSON = document.querySelector("#local");
      btnLocalJSON.addEventListener("click", getAllUsersFromLocalFile);

      function getAllUsersFromLocalFile() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const responseAsObject = JSON.parse(this.responseText);
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'users.js', true);
        users.send();
      }
    </script>

    <!-- ================= Get data from GitHub API ================= -->
    <fieldset>
      <legend>Get users from GitHub API</legend>
      <button id="github">Send Request</button>
      <span id="userGithub"></span>
    </fieldset>

    <script>
      const btnGithub = document.querySelector("#github");
      btnGithub.addEventListener("click", getUsersFromGithub);

      function getUsersFromGithub() {
        const users = new XMLHttpRequest();

        users.onload = function () {
          if (this.status === 200) {
            try {
              const usersAsArray = JSON.parse(this.responseText);
              const display = document.querySelector("#userGithub");
              const randomIndex = Math.floor(Math.random() * 30);
              display.textContent = usersAsArray[randomIndex].login;
            } catch (error) {
              console.warn('Did not parse the data!');
            }
          } else {
            console.warn('Did not receive the data!');
          }
        };
  
        users.open('get', 'https://api.github.com/users', true);
        users.send();
      }
    </script>

    <script>
      const matches4 = `
      40 Desert Blade (Fragment)
40 Minotaur's Head (Fragment)
40 Diviner's Orb - Recipe (Fragment)
50 Panoptic Orb - Recipe (Fragment)
80 Hand of Glory (Fragment)

40 Book of Prophecies - Recipe (Fragment)
50 Book of Fate - Recipe (Fragment)
80 Flaming Heart (Fragment)
160 Pastor's Seal (Fragment)

80 Riversar's Tiara (Fragment)
`;
      const matches3 = `740/120/100      640/320/150`;

const patern = /[0-9]+/g;

const result = matches3.match(patern).reduce((acc, n) => acc + Number(n), 0);
console.log(result);
    </script>
  </body>
</html>