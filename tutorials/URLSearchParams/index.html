<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URLSearchParams in JS</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  </head>
  <body>
    <h1>URLSearchParams in JavaScript - Constructing Query Strings</h1>

    <script src="./in-fetch-api.js"></script>
    <script src="js.js">
      // Create Query String as String
      const queryStringSample = 'name=Dom&age=36&occupation=Software+Developer';
      // Create URLSearchParams Object from String
      const uspFromString = new URLSearchParams(queryStringSample);
      console.log(uspFromString);


      // Create Query String as Object
      const queryStringSampleAsObject = {
        name: 'Dom',
        age: 36,
        occupation: 'Software Developer',
      };

      // Create URLSearchParams Object from Object
      const uspFromObject = new URLSearchParams(queryStringSampleAsObject);

      // Get Param from URLSearchParams
      const name = uspFromObject.get('name');
      console.log(`Value of 'name': ${name}`);

      // Change Param in URLSearchParams
      uspFromObject.set('name', 'New Name');
      // Set New Param in URLSearchParams
      uspFromObject.set('programming language', 'JavaScript');

      for (const [key, value] of uspFromObject) {
        console.log(`${key} => ${value}`);
      }

      // Convert URLSearchParams Object to Query String
      console.log(uspFromString.toString());
      console.log(uspFromObject.toString());
    </script>

    <script src="doestexist.js">
      const course = {
        name: "Web Programming", 
        score: 75
      }

      const grade = {
        score: 12
      }

      const studentInfo = Object.assign(course, grade, {teacher: "Mrs Water"});

      console.log(studentInfo);

      const copy = Object.assign({}, studentInfo);

      studentInfo.score = 55;

      console.log(studentInfo);
      console.log(copy);
    </script>
    <script>
      function printName(options) {
        const defaults = {
          firstName: "Steve", 
          lastname: "Jobs"
        }

        options = Object.assign(defaults, options);

        console.log(`${options.firstName} ${options.lastname}`);
      }

      // printName({
        // firstName: "Jogata", 
        // lastname: "SoftUni"
      // })
    </script>
    <script>
      const user = {
        username: "Jogata", 
        age: 43, 
        active: true, 
        friends: ["Matt", "Ange", "Johnny"]
      }

      // const userCopy = { ...user };
      // const userCopy = Object.assign({}, user);
      const userCopy = JSON.parse(JSON.stringify(user));

      user.age = 23;
      user.friends.push("Dom");

      console.log(userCopy);
      console.log(userCopy.friends === user.friends);
      console.log(userCopy === user);

      const hasEvenNumber = (numbers) => {
        let retVal;

        for (let i = 0; i < numbers.length; i++) {
          if (numbers[i] % 2 === 0) {
            return true;
          }
        }

        return false;
        
      }
    </script>

    <script>
            // 03. The Pianist

            function organizePieces(params) {
        const pieces = [];
        const n = Number(params[0]);

        for (let index = 1; index <= n; index++) {
          const rawData = params[index];
          // console.log(rawData);
          if (rawData == "Stop") {
            // console.log("break");
            return;
          }
          const data = rawData.split("|");
          pieces.push(data);
        }

        for (let index = n + 1; index < params.length; index++) {
          const rawData = params[index];
          const data = rawData.split("|");
          const operation = data[0];
          const pieceName = data[1];

          if (operation == "Add") {
            // console.log("Add");
            let has = false;
            for (const piece of pieces) {
              // console.log(pieceName, piece[0]);
              if (pieceName == piece[0]) {
                has = true;
              }
            }
            if (has) {
              console.log(`${pieceName} is already in the collection!`);
            } else {
              console.log(`${pieceName} by ${data[2]} in ${data[3]} added to the collection!`);
              const pieceInfo = data.slice(1);
              pieces.push(pieceInfo);
            }
          } else if (operation == "Remove") {
            // console.log("Remove");
            let has = false;
            for (let index = 0; index < pieces.length; index++) {
              // console.log(pieceName, piece[0]);
              if (pieceName == pieces[index][0]) {
                pieces.splice(index, 1);
                has = true;
              }
            }
            if (has) {
              console.log(`Successfully removed ${pieceName}!`);
            } else {
              console.log(`Invalid operation! ${pieceName} does not exist in the collection.`);
            }
          } else if (operation == "ChangeKey") {
            // console.log("ChangeKey");
            for (let index = 0; index < pieces.length; index++) {
              // console.log(pieceName, piece[0]);
              if (pieceName == pieces[index][0]) {
                pieces[index][2] = data[2];
                has = true;
              }
            }
            if (has) {
              console.log(`Changed the key of ${pieceName} to ${data[2]}!`);
            } else {
              console.log(`Invalid operation! ${pieceName} does not exist in the collection.`);
            }
          } else if (operation == "Stop") {
            // console.log("Stop");
            for (const piece of pieces) {
              console.log(`${piece[0]} -> Composer: ${piece[1]}, Key: ${piece[2]}`);
              // console.log(pieceName);
            }
          }

        }
      }

      // organizePieces(['3', 'Fur Elise|Beethoven|A Minor', 'Moonlight Sonata|Beethoven|C# Minor', 'Clair de Lune|Debussy|C# Minor', 'Add|Sonata No.2|Chopin|B Minor', 'Add|Hungarian Rhapsody No.2|Liszt|C# Minor', 'Add|Fur Elise|Beethoven|C# Minor', 'Remove|Clair de Lune', 'ChangeKey|Moonlight Sonata|C# Major', 'Stop']);
      // organizePieces(['4', 'Eine kleine Nachtmusik|Mozart|G Major', 'La Campanella|Liszt|G# Minor', 'The Marriage of Figaro|Mozart|G Major', 'Hungarian Dance No.5|Brahms|G Minor', 'Add|Spring|Vivaldi|E Major', 'Remove|The Marriage of Figaro', 'Remove|Turkish March', 'ChangeKey|Spring|C Major', 'Add|Nocturne|Chopin|C# Minor', 'Stop']);
      // organizePieces(["4", "1|2|3", "4|5|6", "7|8|9", "0|0|0", "Stop"]);
    </script>
    <script>
      // 01. SoftUni Reception

      function reception(params) {
        const f = Number(params[0]);
        const s = Number(params[1]);
        const t = Number(params[2]);

        let students = Number(params[3]);

        const total = f + s + t;
        // let time = 0;

        // let time = students / total;

        // let breaks = time / 3;

        // if (time >= 3) {
          // time++;
        // }

        // breaks = Math.floor(breaks);
        // console.log(breaks);

        // time = time + breaks;

        // time = Math.ceil(time);

        // if (total * 3 * breaks == students) {
        //   time--;
        // }

        let time = 0;
        let breakTime = 0;

        while (students >= total) {
          students = students - total;
          time++;
          breakTime++;
          
          console.log(students, time);

          if (breakTime % 3 == 0 && students > 0) {
            time++;
            breakTime = 0;
          }
          
        }

        if (students > 0) {
          time++;
        }

        console.log(`Time needed: ${time}h.`);

      }

      // reception(['5','6','4','20']);
      // reception(['1','2','3','45']);
      // reception(['3','2','5','40']);
      // reception(['3','2','5','60']);

      // 02. Array Modifier

      function modArray(params) {
        let numbers = params[0]
                          .split(" ")
                          .map(x => Number(x));
        // console.log(numbers);

        // const test = [1, 2, 3]
        // test.map(x => x + 1);
        // console.log(test);

        for (let index = 1; index < params.length; index++) {
          const rawData = params[index];
          const data = rawData.split(" ");
          const operation = data[0];

          if (operation == "swap") {
            // console.log("swap");
            const index1 = Number(data[1]);
            const index2 = Number(data[2]);
            // console.log(index1, index2);
            const old = numbers[index1];
            numbers[index1] = numbers[index2];
            numbers[index2] = old;
          } else if (operation == "multiply") {
            // console.log("multiply");
            const index1 = Number(data[1]);
            const index2 = Number(data[2]);
            numbers[index1] = numbers[index1] * numbers[index2];
          } else if (operation == "decrease") {
            // console.log("decrease");
            numbers = numbers.map(num => num - 1);
          }
        }

        console.log(numbers.join(", "));

      }

      // modArray(['23 -2 321 87 42 90 -123', 'swap 1 3', 'swap 3 6', 'swap 1 0', 'multiply 1 2', 'multiply 2 1', 'decrease', 'end']);
      // modArray(['1 2 3 4', 'swap 0 1', 'swap 1 2', 'swap 2 3', 'multiply 1 2', 'decrease', 'end']);

      // 03. Numbers

      function printTopFive(params) {
        const numbers = params
        .split(" ")
        .map(x => Number(x));

        let average = 0;
        let sum = 0;

        for (let index = 0; index < numbers.length; index++) {
          sum = sum + numbers[index];
        }

        average = sum / numbers.length;
        // console.log(average);

        const filtered = numbers.filter(x => x > average);
        // console.log(filtered);
        const sorted = filtered.sort((a, b) => b - a);
        const sliced = sorted.slice(0, 5);
        
        if (sliced.length == 0) {
          console.log("No");
        } else {
          console.log(sliced.join(" "));
        }

      }

      // printTopFive("10 20 30 40 50");
      // printTopFive("5 2 3 4 -10 30 40 50 20 50 60 60 51");
      // printTopFive("1");
      // printTopFive('-1 -2 -3 -4 -5 -6');
    </script>
    <script>
      // 01. Counter-Strike

      function playCS(params) {
        let energy = Number(params[0]);
        let index = 1;
        let input = params[index];
        let wins = 0;
        let ended = false;

        while (input != "End of battle") {
          let dist = Number(input);

          if (energy >= dist) {
            energy -= dist;
            wins++;

            if (wins % 3 == 0) {
              energy += wins;
            }
          } else {
            ended = true;
            console.log(`Not enough energy! Game ends with ${wins} won battles and ${energy} energy`);
            break;
          }

          // console.log(dist);
          // if (index > 50) {
          //   console.log("infinity");
          //   break;
          // }

          index++;
          input = params[index];
        }

        // console.log(wins);
        // console.log(energy);
        if (ended == false) {
          console.log(`Won battles: ${wins}. Energy left: ${energy}`);
        }

      }

      // playCS(["100", "10", "10", "10", "1", "2", "3", "73", "10"]);
      // playCS(["200", "54", "14", "28", "13", "End of battle"]);

      // 02. Shoot for the Win

      function playShoot(params) {
        const numbers = params[0]
        .split(" ")
        .map(x => Number(x));

        let shots = 0;

        // console.log(numbers);

        for (let index = 1; index < params.length - 1; index++) {
          // console.log(params[index]);
          const position = Number(params[index]);
          // console.log(position);
          if (position < numbers.length && position >= 0) {
            const value = numbers[position];
            // console.log(value);
            if (value != -1) {
              shots++;
              numbers[position] = -1;
              
              for (let index = 0; index < numbers.length; index++) {
                if (numbers[index] != -1) {
                  if (numbers[index] > value) {
                    numbers[index] = numbers[index] - value;
                  } else {
                    numbers[index] = numbers[index] + value;
                  }
                }
              }
            }
          }
        }

        console.log(`Shot targets: ${shots} -> ${numbers.join(" ")}`);
        // console.log(shots);
      }

      // playShoot(["24 50 36 70", "0", "4", "3", "1", "End"]);
      // playShoot(["30 30 12 60 54 66", "5", "2", "4", "0", "End"]);

      // 03. Moving Target

      function trackTargets(params) {
        const numbers = params[0]
        .split(" ")
        .map(x => Number(x));
        // console.log(numbers);
        for (let index = 1; index < params.length; index++) {
          const rawData = params[index];
          const data = rawData.split(" ");
          const operation = data[0];
          // console.log(operation);

          if (operation == "Shoot") {
            // console.log("Shoot");
            const index = Number(data[1]);
            const power = Number(data[2]);

            if (index < numbers.length && index >= 0) {
              numbers[index] -= power;

              if (numbers[index] <= 0) {
                numbers.splice(index, 1);
              }
            }
          } else if (operation == "Strike") {
            // console.log("Strike");
            const index = Number(data[1]);
            const range = Number(data[2]);
            // console.log(index, range);
            if (index < 0 || index >= numbers.length) {
              console.log("Strike missed!");
            } else if (index - range < 0 || index + range >= numbers.length) {
              console.log("Strike missed!");
            } else {
              const start = index - range;
              const area = range + 1 + range;
              numbers.splice(start, area);
            }
          } else if (operation == "Add") {
            // console.log("Add");
            const index = Number(data[1]);
            const value = Number(data[2]);
            if (index <= numbers.length && index >= 0) {
              // console.log(index, value);
              numbers.splice(index, 0, value);
            } else {
              console.log("Invalid placement!");
            }
          } else if (operation == "End") {
            // console.log("End");
            index = params.length;
            console.log(numbers.join("|"));
          }
        }
        
        // console.log(numbers);
        // console.log(numbers.join("|"));
      }

      function trackTargets(params) {
        const numbers = params[0]
        .split(" ")
        .map(x => Number(x));
        // console.log(numbers);
        let index = 1;
        let input = params[index]

        while (input != "End") {
          const rawData = params[index];
          const data = rawData.split(" ");
          const operation = data[0];
          // console.log(operation);

          if (operation == "Shoot") {
            // console.log("Shoot");
            const index = Number(data[1]);
            const power = Number(data[2]);

            if (index < numbers.length && index >= 0) {
              numbers[index] -= power;

              if (numbers[index] <= 0) {
                numbers.splice(index, 1);
              }
            }
          } else if (operation == "Strike") {
            // console.log("Strike");
            const index = Number(data[1]);
            const range = Number(data[2]);
            // console.log(index, range);
            if (index >= 0 && index < numbers.length) {
              // console.log("Strike missed!");
            // } else 
            if (index - range < 0 || index + range >= numbers.length) {
              console.log("Strike missed!");
            } else {
              const start = index - range;
              const area = range + 1 + range;
              console.log(start, area);
              numbers.splice(start, area);
            }
          }
          } else if (operation == "Add") {
            // console.log("Add");
            const index = Number(data[1]);
            const value = Number(data[2]);
            if (index < numbers.length && index >= 0) {
              // console.log(index, value);
              numbers.splice(index, 0, value);
            } else {
              console.log("Invalid placement!");
            }
          } else if (operation == "test") {
            // console.log("End");
            // index = params.length;
            // console.log(numbers.join("|"));
          }

          index++;
          input = params[index];

          if (index > 50) {
            console.log("infinity");
            break;
          }
        }
        
        // console.log(numbers);
        console.log(numbers.join("|"));
      }

      // trackTargets(["52 74 23 44 96 110", "Shoot 5 10", "Shoot 1 80", "Strike 2 1", "Add 22 3", "End"]);
      // trackTargets(["1 2 3 4 5", "Strike 0 1", "End"]);
      // trackTargets(["1 2 3 4 5", "Strike 1 -1", "End"]);
      // trackTargets(["1 2 3 4 5", "Shoot 4 2", "End"]);
      // trackTargets(["1 2 3 4 5", "Shoot 0 1", "Shoot 0 2", "Shoot 0 3", "Shoot 0 4", "Shoot 0 6", "End"]);
      // trackTargets(["1 2 3 4 5", "Shoot -1 1", "End"]);
      // trackTargets(["1 2 3 4 5", "Shoot 5 1", "End"]);
      // trackTargets(["1 2 3 4 5", "Add 5 8", "End"]);
      // trackTargets(["1 2 3 4 5", "Add 5 6", "End"]);
    </script>
    <script>
      // 01. Guinea Pig

      function feedPig(params) {
        const food = Number(params[0]) * 1000;
        const hay = Number(params[1]) * 1000;
        const cover = Number(params[2]) * 1000;
        const weight = Number(params[3]) * 1000;
        let isEn = true;

        let foodLeft = food;
        let hayLeft = hay;
        let coverLeft = cover;

        const foodDaily = 300;

        for (let day = 1; day <= 30; day++) {
          foodLeft -= foodDaily;

          if (day % 2 == 0) {
            const dailyHay = foodLeft * 0.05;
            hayLeft -= dailyHay;
          }

          if (day % 3 == 0) {
            const usedCover = weight / 3;
            coverLeft -= usedCover;
          }

          if (foodLeft <= 0 || hayLeft <= 0 || coverLeft <= 0) {
            isEn = false;
            day = 30;
          }
        }

        foodLeft = foodLeft / 1000;
        hayLeft = hayLeft / 1000;
        coverLeft = coverLeft / 1000;

        if (isEn) {
          console.log(`Everything is fine! Puppy is happy! Food: ${foodLeft.toFixed(2)}, Hay: ${hayLeft.toFixed(2)}, Cover: ${coverLeft.toFixed(2)}.`);
        } else {
          console.log("Merry must go to the pet store!");
        }

      }

      // feedPig((["10", "5", "5.2", "1"]));
      // feedPig(["1", "1.5", "3", "1.5"]);
      // feedPig(["9", "5", "5.2", "1"]);

      // 02. Shopping List

      function menageList(params) {
        const list = params[0].split("!");
        // console.log(list);
        let index = 1;
        let input = params[index];

        while (input != "Go Shopping!") {
          const data = input.split(" ");
          const command = data[0];

          if (command == "Urgent") {
            // console.log("Urgent");
            const item = data[1];
            // console.log(item);
            if (!list.includes(item)) {
              list.unshift(item);
            }
          } else if (command == "Unnecessary") {
            // console.log("Unnecessary");
            const item = data[1];
            // console.log(item);
            const index = list.indexOf(item);
            if (index >= 0) {
              list.splice(index, 1);
            }
          } else if (command == "Correct") {
            // console.log("Correct");
            const oldItem = data[1];
            const newItem = data[2];
            // console.log(oldItem, newItem);
            const index = list.indexOf(oldItem);
            if (index >= 0) {
              list[index] = newItem;
            }
          } else if (command == "Rearrange") {
            // console.log("Rearrange");
            const item = data[1];
            // console.log(item);
            const index = list.indexOf(item);
            if (index >= 0) {
              list.splice(index, 1);
              list.push(item);
            }
          }

          index++;
          input = params[index];

          // if (index > 50) {
          //   console.log("infinity");
          //   break;
          // }
        }

        console.log(list.join(", "));

      }

      // menageList(["Tomatoes!Potatoes!Bread", "Unnecessary Milk", "Urgent Tomatoes", "Go Shopping!"]);
      // menageList(["Milk!Pepper!Salt!Water!Banana", "Urgent Salt", "Unnecessary Grapes", "Correct Pepper Onion", "Rearrange Grapes", "Correct Tomatoes Potatoes", "Go Shopping!"]);

      // 03. Heart Delivery

      function deliverHeart(params) {
        const houses = params[0]
        .split("@")
        .map(x => Number(x));
        // console.log(houses);
        let index = 1;
        let input = params[index];
        let currentHouse = 0;

        while (input != "Love!") {
          const data = input.split(" ");
          const jumpLength = Number(data[1]);
          // console.log(data);
          // console.log(typeof jumpLength);

          currentHouse += jumpLength;
          // console.log(currentHouse);

          if (currentHouse >= houses.length) {
            currentHouse = 0;
            // while (currentHouse >= houses.length) {
            //   currentHouse -= houses.length;
            // }
            // console.log(currentHouse);
            // let iteration = Math.floor(currentHouse / houses.length);
            // currentHouse = currentHouse % houses.length;
            // for (let index = 0; index < jumpLength; index++) {
            //   currentHouse++;
            //   currentHouse = currentHouse % houses.length;
              // console.log(currentHouse);
            // }
            // console.log(iteration, index);
            // currentHouse = currentHouse - (iteration * houses.length);
            // const last = houses.length - 1;
          }

          if (houses[currentHouse] > 0) {
            houses[currentHouse] = houses[currentHouse] - 2;

            if (houses[currentHouse] == 0) {
              console.log(`Place ${currentHouse} has Valentine's day.`);
            }
          } else {
            console.log(`Place ${currentHouse} already had Valentine's day.`);
          }

          index++;
          input = params[index];

          if (index > 50) {
            console.log("infinity");
            break;
          }
        }

        // console.log(houses);
        console.log(`Cupid's last position was ${currentHouse}.`);
        const filtered = houses.filter(x => x > 0);

        if (filtered.length == 0) {
          console.log(`Mission was successful.`);
        } else {
          console.log(`Cupid has failed ${filtered.length} places.`);
        }

      }

      // deliverHeart(["10@10@10@2", "Jump 1", "Jump 2", "Love!"]);
      // deliverHeart(["2@4@2", "Jump 2", "Jump 2", "Jump 8", "Jump 3", "Jump 1", "Love!"]);
      // deliverHeart(["2@4@2", "Jump 2", "Jump 2", "Love!"]);/
    </script>
    <script>
      // 01. Bonus Scoring System

      function calcBonus(params) {
        const students = Number(params[0]);
        const lectures = Number(params[1]);
        const lectureBonus = Number(params[2]);

        const attendances = params.slice(3).map(x => Number(x));

        // console.log(attendances);

        let max = 0;
        let a = 0;

        for (let index = 0; index < students; index++) {
          let bonus =  attendances[index] / lectures * (5 + lectureBonus);
          bonus = Math.round(bonus);
          if (bonus > max) {
            max = bonus;
            a = attendances[index];
          }
        }

        console.log(`Max Bonus: ${max}.`);
        console.log(`The student has attended ${a} lectures.`);

      }

      // calcBonus(['5',  '25', '30', '12', '19', '24', '16', '20']);
      // calcBonus(['10', '30', '14', '8', '23', '27', '28', '15', '17', '25', '26', '5', '18']);

      // 02. MuOnline

      // 03. Inventory

      function craft(params) {
        const items = params[0].split(", ");
        // console.log(items);
        let index = 1;
        let input = params[index];

        while (input != "Craft!") {
          const data = input.split(" - ");
          // console.log(data);
          const operation = data[0];
          const item = data[1];
          // console.log(operation, "/", item);

          if (operation == "Collect") {
            // console.log("Collect");
            const index = items.indexOf(item);
            if (index == -1) {
              items.push(item);
            }
          } else if (operation == "Drop") {
            // console.log("Drop");
            const index = items.indexOf(item);
            if (index != -1) {
              items.splice(index, 1);
            }
          } else if (operation == "Combine Items") {
            // console.log("Combine Items");
            const tokens = item.split(":");
            const oldItem = tokens[0];
            const newItem = tokens[1];
            const index = items.indexOf(oldItem);
            if (index != -1) {
              items.splice(index + 1, 0, newItem);
            }
            // console.log(typeof item, item);
            // console.log(tokens);
          } else if (operation == "Renew") {
            // console.log("Renew");
            const index = items.indexOf(item);
            if (index != -1) {
              items.splice(index, 1);
              items.push(item);
            }
          }

          index++;
          input = params[index];

          // if (index > 10) {
          //   console.log("infinity");
          //   break;
          // }
        }

        console.log(items.join(", "));

      }

      // craft(['Iron, Wood, Sword', 'Collect - Gold', 'Drop - Wood', 'Craft!']);
      // craft(['Iron, Sword', 'Drop - Bronze', 'Combine Items - Sword:Bow', 'Renew - Iron', 'Craft!']);
    </script>
  </body>
</html>