
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URLSearchParams in JS</title>
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css"/> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  </head>
  <body>
    <h1>URLSearchParams in JavaScript - Constructing Query Strings</h1>

<header>
  <h2>JS Advanced Regular Exam - 13 March 2022</h2>
  <a href="../../00exams/JS Advanced Regular Exam - 13 March 2022">Open folder</a>
  03. Rent Car
</header>

<script>
  const rentCar = {
    searchCar(shop, model) {
        let findModel = [];

        if (Array.isArray(shop) && typeof model == 'string') {
            for (let i = 0; i < shop.length; i++) {
                if (model == shop[i]) {
                    findModel.push(shop[i]);
                }
            }

            if (findModel.length !== 0) {
                return `There is ${findModel.length} car of model ${model} in the catalog!`;
            } else {
                throw new Error('There are no such models in the catalog!');
            }
        } else {
            throw new Error('Invalid input!');
        }
    },
    calculatePriceOfCar(model, days) {
        let catalogue = {
            Volkswagen: 20,
            Audi: 36,
            Toyota: 40,
            BMW: 45,
            Mercedes: 50
        };

        if (typeof model == 'string' && Number.isInteger(days)) {
            if (catalogue.hasOwnProperty(model)) {
                let cost = catalogue[model] * days;
                return `You choose ${model} and it will cost $${cost}!`;
            } else {
                throw new Error('No such model in the catalog!');
            }
        } else {
            throw new Error('Invalid input!');
        }
    },
    checkBudget(costPerDay, days, budget) {
        if (
            !Number.isInteger(costPerDay) || 
            !Number.isInteger(days) || 
            !Number.isInteger(budget)
        ) {
            throw new Error('Invalid input!');
        } else {
            let cost = costPerDay * days;

            if (cost <= budget) {
                return `You rent a car!`;
            } else {
                return 'You need a bigger budget!';
            }
        }
    }
}

describe("rentCar test suit", function () {

    describe("searchCar", function () {
        it("When there are matching elements return count", function () {
            assert(rentCar.searchCar(["Volkswagen", "BMW", "Audi", "BMW"], 'BMW'),
                'There is 2 car of model BMW in the catalog!');
            assert(rentCar.searchCar(["Volkswagen", "BMW", "Audi", "BMW"], 'Audi'),
                'There is 1 car of model Audi in the catalog!');
        });

        it('In case of submitted invalid parameters, throw an error "Invalid input!"', () => {
            assert.throws(() => rentCar.searchCar(), Error, 'Invalid input!');
            assert.throws(() => rentCar.searchCar(1, 2), Error, 'Invalid input!');
            assert.throws(() => rentCar.searchCar('["A","B"]', null), Error, 'Invalid input!');
        })

        it('If there are no matching elements, the function throw an error', () => {
            assert.throws(() => rentCar.searchCar(["Volkswagen", "BMW", "Audi", "BMW"], 'Moskvich'),
                Error, 'There are no such models in the catalog!');
            assert.throws(() => rentCar.searchCar(["Volkswagen", "BMW", "Audi", "BMW"], 'Ford'),
                Error, 'There are no such models in the catalog!');
        })
    });

    describe('calculatePriceOfCar', () => {
        it('In case of submitted invalid parameters, throw an error "Invalid input!"', () => {
            assert.throws(() => rentCar.calculatePriceOfCar(), Error, 'Invalid input!');
            assert.throws(() => rentCar.calculatePriceOfCar('Ford', 2.2), Error, 'Invalid input!');
            assert.throws(() => rentCar.calculatePriceOfCar(null, 2), Error, 'Invalid input!');
        });

        it('returns the model and the price it will cost ', () => {
            assert.equal(rentCar.calculatePriceOfCar('BMW', 2),
                'You choose BMW and it will cost $90!');
            assert.equal(rentCar.calculatePriceOfCar('Mercedes', 3),
                'You choose Mercedes and it will cost $150!');
        });

        it('if there is no such model, the function throw an error: No such model in the catalog!',()=>{
            assert.throws(()=>rentCar.calculatePriceOfCar('Lada', 10), Error, 'No such model in the catalog!');
        });
    });

    describe('checkBudget', ()=>{
        it('Validates input', ()=>{
            assert.throws(()=>rentCar.checkBudget(), Error, 'Invalid input!');
            assert.throws(()=>rentCar.checkBudget('1', 2, 3), Error, 'Invalid input!');
            assert.throws(()=>rentCar.checkBudget(1,'2',3), Error, 'Invalid input!');
            assert.throws(()=>rentCar.checkBudget(1,2,'3'), Error, 'Invalid input!');
        }); 

        it('If the budget is bigger or equal to cost, function return: You rent a car!',()=>{
            assert.equal(rentCar.checkBudget(10,10,150), 'You rent a car!');
            assert.equal(rentCar.checkBudget(10,10,100), 'You rent a car!');
        });


        it('If the budget is less than cost, the function returns the message: You need a bigger budget!',()=>{
            assert.equal(rentCar.checkBudget(10,10,95), 'You need a bigger budget!');
        });

    })

});
</script>

    <script src="./in-fetch-api.js"></script>
    <script src="js.js">
      // Create Query String as String
      const queryStringSample = 'name=Dom&age=36&occupation=Software+Developer';
      // Create URLSearchParams Object from String
      const uspFromString = new URLSearchParams(queryStringSample);
      console.log(uspFromString);


      // Create Query String as Object
      const queryStringSampleAsObject = {
        name: 'Dom',
        age: 36,
        occupation: 'Software Developer',
      };

      // Create URLSearchParams Object from Object
      const uspFromObject = new URLSearchParams(queryStringSampleAsObject);

      // Get Param from URLSearchParams
      const name = uspFromObject.get('name');
      console.log(`Value of 'name': ${name}`);

      // Change Param in URLSearchParams
      uspFromObject.set('name', 'New Name');
      // Set New Param in URLSearchParams
      uspFromObject.set('programming language', 'JavaScript');

      for (const [key, value] of uspFromObject) {
        console.log(`${key} => ${value}`);
      }

      // Convert URLSearchParams Object to Query String
      console.log(uspFromString.toString());
      console.log(uspFromObject.toString());
    </script>
  </body>
</html>