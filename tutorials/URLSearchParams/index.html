<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URLSearchParams in JS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
    <script>
// 05. Nether Realmsâœ¶

function createDemonBook(params) {
// console.log(params);
const data = params.split(",");
// console.log(data);
const demons = [];

const healthPattern = /[^0-9+\-*\/.]/g;
const damagePattern = /[+-]?[0-9.]+/g;
const alterPattern = /[*\/]/g;

for (const string of data) {
  // console.log(string);
  let name = string.split(" ").join("");
  // console.log(name);
  const healthSymbols = name.match(healthPattern);
  // console.log(healthSymbols);
  let hp = healthSymbols.reduce((acc, x) => {
    const ascii = x.charCodeAt(0);
    // console.log(x, ascii);
    return acc + ascii;
  }, 0);
  // console.log(hp);
  const danmageSymbols = name.match(damagePattern) || [];
  // console.log(danmageSymbols);
  let damage = danmageSymbols.reduce((acc, x) => {
    const num = Number(x);
    return acc + num;
  }, 0);
  // console.log(damage);
  const alterSymbols = name.match(alterPattern) || [];
  // console.log(alterSymbols);
  alterSymbols.forEach(x => {
    if (x == "*") {
      damage = damage * 2;
    } else if (x == "/") {
      damage = damage / 2;
    }
  })
  // console.log(damage);

  const demon = {
    name, 
    hp, 
    damage
  }
  // console.log(demon);

  demons.push(demon);

}
// console.log(demons);
demons.sort((a, b) => a.name.localeCompare(b.name));

demons.forEach(demon => {
  console.log(`${demon.name} - ${demon.hp} health, ${demon.damage.toFixed(2)} damage`);
})

}

// createDemonBook("M3ph-0.5s-0.5t0.0**");
// createDemonBook("M3ph1st0**, Aza zel");
// createDemonBook("Gos/ho ");

// 01. Furniture

function calcTotalCost(params) {
// console.log(params);
const furnitures = [];
let total = 0;
let index = 0;
let input = params[index];
// console.log(input);

while (input != "Purchase") {
  // console.log(input);
  const pattern = />>(?<name>[A-z][A-za-z]+)<<(?<price>[\d]+\.?[\d]+)!(?<q>\d+)/;

  const match = input.match(pattern);
  // console.log(match);
  
  if (match) {
    const {name, price, q} = match.groups;
    // console.log(name, price, q);
    furnitures.push(name);
    const cost = Number(price) * Number(q);
    total += cost;
  }
  
  index++;
  input = params[index];

  // if (index > 20) {
  //   console.log("infinity");
  //   break;
  // }
}

// console.log(furnitures);
console.log("Bought furniture:");
for (const name of furnitures) {
  console.log(name);
}

console.log(`Total money spend: ${total.toFixed(2)}`);

}

// calcTotalCost(
//   [
//     '>>Sofa<<312.23!3',
//     '>>TV<<300!5',
//     '>Invalid<<!5',
//     'Purchase'
//   ]
// );
// calcTotalCost(
//   [
//     '>>Laptop<<312.2323!3',
//     '>>TV<<300.21314!5',
//     '>Invalid<<!5',
//     '>>TV<<300.21314!20',
//     '>>Invalid<!5',
//     '>>TV<<30.21314!5',
//     '>>Invalid<<!!5',
//     'Purchase'
//   ]
// );
// calcTotalCost(
//   [
//     '>Invalid<<!4', 
//     '>Invalid<<!2', 
//     '>Invalid<<!5', 
//     'Purchase'
//   ]
// )
    </script>

    <h1>URLSearchParams in JavaScript - Constructing Query Strings</h1>

    <script src="./in-fetch-api.js"></script>
    <script src="js.js">
      // Create Query String as String
      const queryStringSample = 'name=Dom&age=36&occupation=Software+Developer';
      // Create URLSearchParams Object from String
      const uspFromString = new URLSearchParams(queryStringSample);
      console.log(uspFromString);


      // Create Query String as Object
      const queryStringSampleAsObject = {
        name: 'Dom',
        age: 36,
        occupation: 'Software Developer',
      };

      // Create URLSearchParams Object from Object
      const uspFromObject = new URLSearchParams(queryStringSampleAsObject);

      // Get Param from URLSearchParams
      const name = uspFromObject.get('name');
      console.log(`Value of 'name': ${name}`);

      // Change Param in URLSearchParams
      uspFromObject.set('name', 'New Name');
      // Set New Param in URLSearchParams
      uspFromObject.set('programming language', 'JavaScript');

      for (const [key, value] of uspFromObject) {
        console.log(`${key} => ${value}`);
      }

      // Convert URLSearchParams Object to Query String
      console.log(uspFromString.toString());
      console.log(uspFromObject.toString());
    </script>
  </body>
</html>