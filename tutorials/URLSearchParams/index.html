<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URLSearchParams in JS</title>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  </head>
  <body>
    <h1>URLSearchParams in JavaScript - Constructing Query Strings</h1>

    <script src="./in-fetch-api.js"></script>
    <script src="js.js">
      // Create Query String as String
      const queryStringSample = 'name=Dom&age=36&occupation=Software+Developer';
      // Create URLSearchParams Object from String
      const uspFromString = new URLSearchParams(queryStringSample);
      console.log(uspFromString);


      // Create Query String as Object
      const queryStringSampleAsObject = {
        name: 'Dom',
        age: 36,
        occupation: 'Software Developer',
      };

      // Create URLSearchParams Object from Object
      const uspFromObject = new URLSearchParams(queryStringSampleAsObject);

      // Get Param from URLSearchParams
      const name = uspFromObject.get('name');
      console.log(`Value of 'name': ${name}`);

      // Change Param in URLSearchParams
      uspFromObject.set('name', 'New Name');
      // Set New Param in URLSearchParams
      uspFromObject.set('programming language', 'JavaScript');

      for (const [key, value] of uspFromObject) {
        console.log(`${key} => ${value}`);
      }

      // Convert URLSearchParams Object to Query String
      console.log(uspFromString.toString());
      console.log(uspFromObject.toString());
    </script>

    <script>
      const course = {
        name: "Web Programming"
      }

      const grade = {
        score: 92
      }

      const studentInfo = Object.assign(course, grade);
      
      console.log(studentInfo);
    </script>

    <script>
            // 03. The Pianist

            function organizePieces(params) {
        const pieces = [];
        const n = Number(params[0]);

        for (let index = 1; index <= n; index++) {
          const rawData = params[index];
          // console.log(rawData);
          if (rawData == "Stop") {
            // console.log("break");
            return;
          }
          const data = rawData.split("|");
          pieces.push(data);
        }

        for (let index = n + 1; index < params.length; index++) {
          const rawData = params[index];
          const data = rawData.split("|");
          const operation = data[0];
          const pieceName = data[1];

          if (operation == "Add") {
            // console.log("Add");
            let has = false;
            for (const piece of pieces) {
              // console.log(pieceName, piece[0]);
              if (pieceName == piece[0]) {
                has = true;
              }
            }
            if (has) {
              console.log(`${pieceName} is already in the collection!`);
            } else {
              console.log(`${pieceName} by ${data[2]} in ${data[3]} added to the collection!`);
              const pieceInfo = data.slice(1);
              pieces.push(pieceInfo);
            }
          } else if (operation == "Remove") {
            // console.log("Remove");
            let has = false;
            for (let index = 0; index < pieces.length; index++) {
              // console.log(pieceName, piece[0]);
              if (pieceName == pieces[index][0]) {
                pieces.splice(index, 1);
                has = true;
              }
            }
            if (has) {
              console.log(`Successfully removed ${pieceName}!`);
            } else {
              console.log(`Invalid operation! ${pieceName} does not exist in the collection.`);
            }
          } else if (operation == "ChangeKey") {
            // console.log("ChangeKey");
            for (let index = 0; index < pieces.length; index++) {
              // console.log(pieceName, piece[0]);
              if (pieceName == pieces[index][0]) {
                pieces[index][2] = data[2];
                has = true;
              }
            }
            if (has) {
              console.log(`Changed the key of ${pieceName} to ${data[2]}!`);
            } else {
              console.log(`Invalid operation! ${pieceName} does not exist in the collection.`);
            }
          } else if (operation == "Stop") {
            // console.log("Stop");
            for (const piece of pieces) {
              console.log(`${piece[0]} -> Composer: ${piece[1]}, Key: ${piece[2]}`);
              // console.log(pieceName);
            }
          }

        }
      }

      // organizePieces(['3', 'Fur Elise|Beethoven|A Minor', 'Moonlight Sonata|Beethoven|C# Minor', 'Clair de Lune|Debussy|C# Minor', 'Add|Sonata No.2|Chopin|B Minor', 'Add|Hungarian Rhapsody No.2|Liszt|C# Minor', 'Add|Fur Elise|Beethoven|C# Minor', 'Remove|Clair de Lune', 'ChangeKey|Moonlight Sonata|C# Major', 'Stop']);
      // organizePieces(['4', 'Eine kleine Nachtmusik|Mozart|G Major', 'La Campanella|Liszt|G# Minor', 'The Marriage of Figaro|Mozart|G Major', 'Hungarian Dance No.5|Brahms|G Minor', 'Add|Spring|Vivaldi|E Major', 'Remove|The Marriage of Figaro', 'Remove|Turkish March', 'ChangeKey|Spring|C Major', 'Add|Nocturne|Chopin|C# Minor', 'Stop']);
      // organizePieces(["4", "1|2|3", "4|5|6", "7|8|9", "0|0|0", "Stop"]);
    </script>
    <script>
      // 01. SoftUni Reception

      function reception(params) {
        const f = Number(params[0]);
        const s = Number(params[1]);
        const t = Number(params[2]);

        let students = Number(params[3]);

        const total = f + s + t;
        // let time = 0;

        // let time = students / total;

        // let breaks = time / 3;

        // if (time >= 3) {
          // time++;
        // }

        // breaks = Math.floor(breaks);
        // console.log(breaks);

        // time = time + breaks;

        // time = Math.ceil(time);

        // if (total * 3 * breaks == students) {
        //   time--;
        // }

        let time = 0;
        let breakTime = 0;

        while (students >= total) {
          students = students - total;
          time++;
          breakTime++;
          
          console.log(students, time);

          if (breakTime % 3 == 0 && students > 0) {
            time++;
            breakTime = 0;
          }
          
        }

        if (students > 0) {
          time++;
        }

        console.log(`Time needed: ${time}h.`);

      }

      // reception(['5','6','4','20']);
      // reception(['1','2','3','45']);
      // reception(['3','2','5','40']);
      // reception(['3','2','5','60']);

      // 02. Array Modifier

      function modArray(params) {
        let numbers = params[0]
                          .split(" ")
                          .map(x => Number(x));
        // console.log(numbers);

        // const test = [1, 2, 3]
        // test.map(x => x + 1);
        // console.log(test);

        for (let index = 1; index < params.length; index++) {
          const rawData = params[index];
          const data = rawData.split(" ");
          const operation = data[0];

          if (operation == "swap") {
            // console.log("swap");
            const index1 = Number(data[1]);
            const index2 = Number(data[2]);
            // console.log(index1, index2);
            const old = numbers[index1];
            numbers[index1] = numbers[index2];
            numbers[index2] = old;
          } else if (operation == "multiply") {
            // console.log("multiply");
            const index1 = Number(data[1]);
            const index2 = Number(data[2]);
            numbers[index1] = numbers[index1] * numbers[index2];
          } else if (operation == "decrease") {
            // console.log("decrease");
            numbers = numbers.map(num => num - 1);
          }
        }

        console.log(numbers.join(", "));

      }

      // modArray(['23 -2 321 87 42 90 -123', 'swap 1 3', 'swap 3 6', 'swap 1 0', 'multiply 1 2', 'multiply 2 1', 'decrease', 'end']);
      // modArray(['1 2 3 4', 'swap 0 1', 'swap 1 2', 'swap 2 3', 'multiply 1 2', 'decrease', 'end']);

      // 03. Numbers

      function printTopFive(params) {
        const numbers = params
        .split(" ")
        .map(x => Number(x));

        let average = 0;
        let sum = 0;

        for (let index = 0; index < numbers.length; index++) {
          sum = sum + numbers[index];
        }

        average = sum / numbers.length;
        // console.log(average);

        const filtered = numbers.filter(x => x > average);
        // console.log(filtered);
        const sorted = filtered.sort((a, b) => b - a);
        const sliced = sorted.slice(0, 5);
        
        if (sliced.length == 0) {
          console.log("No");
        } else {
          console.log(sliced.join(" "));
        }

      }

      // printTopFive("10 20 30 40 50");
      // printTopFive("5 2 3 4 -10 30 40 50 20 50 60 60 51");
      // printTopFive("1");
      // printTopFive('-1 -2 -3 -4 -5 -6');
    </script>
    <script>
      // 01. Counter-Strike

      function playCS(params) {
        let energy = Number(params[0]);
        let index = 1;
        let input = params[index];
        let wins = 0;
        let ended = false;

        while (input != "End of battle") {
          let dist = Number(input);

          if (energy >= dist) {
            energy -= dist;
            wins++;

            if (wins % 3 == 0) {
              energy += wins;
            }
          } else {
            ended = true;
            console.log(`Not enough energy! Game ends with ${wins} won battles and ${energy} energy`);
            break;
          }

          // console.log(dist);
          // if (index > 50) {
          //   console.log("infinity");
          //   break;
          // }

          index++;
          input = params[index];
        }

        // console.log(wins);
        // console.log(energy);
        if (ended == false) {
          console.log(`Won battles: ${wins}. Energy left: ${energy}`);
        }

      }

      // playCS(["100", "10", "10", "10", "1", "2", "3", "73", "10"]);
      // playCS(["200", "54", "14", "28", "13", "End of battle"]);

      // 02. Shoot for the Win
      // 03. Moving Target
    </script>
  </body>
</html>